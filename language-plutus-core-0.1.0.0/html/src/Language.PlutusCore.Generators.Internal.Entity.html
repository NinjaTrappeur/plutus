<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Generators of various PLC things: 'Builtin's, 'IterApp's, 'Term's, etc.</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE GADTs                 #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings     #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE RankNTypes            #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances  #-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.PlutusCore.Generators.Internal.Entity</span><span>
</span><a name="line-11"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#PlcGenT"><span class="hs-identifier hs-type">PlcGenT</span></a><span>
</span><a name="line-12"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#IterAppValue"><span class="hs-identifier hs-type">IterAppValue</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#runPlcT"><span class="hs-identifier hs-var">runPlcT</span></a><span>
</span><a name="line-14"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genSizeIn"><span class="hs-identifier hs-var">genSizeIn</span></a><span>
</span><a name="line-15"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genSizeDef"><span class="hs-identifier hs-var">genSizeDef</span></a><span>
</span><a name="line-16"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genSizeFrom"><span class="hs-identifier hs-var">genSizeFrom</span></a><span>
</span><a name="line-17"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genBuiltinSized"><span class="hs-identifier hs-var">genBuiltinSized</span></a><span>
</span><a name="line-18"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genBuiltin"><span class="hs-identifier hs-var">genBuiltin</span></a><span>
</span><a name="line-19"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#withTypedBuiltinGen"><span class="hs-identifier hs-var">withTypedBuiltinGen</span></a><span>
</span><a name="line-20"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#withCheckedTermGen"><span class="hs-identifier hs-var">withCheckedTermGen</span></a><span>
</span><a name="line-21"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genIterAppValue"><span class="hs-identifier hs-var">genIterAppValue</span></a><span>
</span><a name="line-22"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genTerm"><span class="hs-identifier hs-var">genTerm</span></a><span>
</span><a name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genTermLoose"><span class="hs-identifier hs-var">genTermLoose</span></a><span>
</span><a name="line-24"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#withAnyTermLoose"><span class="hs-identifier hs-var">withAnyTermLoose</span></a><span>
</span><a name="line-25"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.PlutusCore.html"><span class="hs-identifier">Language.PlutusCore</span></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.PlutusCore.Constant.html"><span class="hs-identifier">Language.PlutusCore.Constant</span></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.PlutusCore.Generators.Internal.Denotation.html"><span class="hs-identifier">Language.PlutusCore.Generators.Internal.Denotation</span></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html"><span class="hs-identifier">Language.PlutusCore.Generators.Internal.TypedBuiltinGen</span></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.PlutusCore.Generators.Internal.TypeEvalCheck.html"><span class="hs-identifier">Language.PlutusCore.Generators.Internal.TypeEvalCheck</span></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.PlutusCore.Generators.Internal.Utils.html"><span class="hs-identifier">Language.PlutusCore.Generators.Internal.Utils</span></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span>           </span><a href="PlutusPrelude.html"><span class="hs-identifier">PlutusPrelude</span></a><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Exception</span><span>                                       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">evaluate</span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Exception.Safe</span><span>                                  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tryAny</span><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Monad.Reader</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Dependent.Map</span><span>                                      </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">DMap</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Functor.Compose</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Text.Prettyprint.Doc</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Hedgehog</span><span>                                                </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Size</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Var</span><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Hedgehog.Gen</span><span>                                            </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Gen</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Hedgehog.Range</span><span>                                          </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Range</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">System.IO.Unsafe</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">-- | Generators of built-ins supplied to computations that run in the 'PlcGenT' monad.</span><span>
</span><a name="line-47"></a><span class="hs-keyword">data</span><span> </span><a name="BuiltinGensT"><a href="Language.PlutusCore.Generators.Internal.Entity.html#BuiltinGensT"><span class="hs-identifier">BuiltinGensT</span></a></a><span> </span><a name="local-6989586621679666988"><a href="#local-6989586621679666988"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="BuiltinGensT"><a href="Language.PlutusCore.Generators.Internal.Entity.html#BuiltinGensT"><span class="hs-identifier">BuiltinGensT</span></a></a><span>
</span><a name="line-48"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="_builtinGensSize"><a href="Language.PlutusCore.Generators.Internal.Entity.html#_builtinGensSize"><span class="hs-identifier">_builtinGensSize</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="#local-6989586621679666988"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span>         </span><span class="hs-comment">-- ^ Generates a 'Size'.</span><span>
</span><a name="line-49"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_builtinGensTyped"><a href="Language.PlutusCore.Generators.Internal.Entity.html#_builtinGensTyped"><span class="hs-identifier">_builtinGensTyped</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TypedBuiltinGenT"><span class="hs-identifier hs-type">TypedBuiltinGenT</span></a><span> </span><a href="#local-6989586621679666988"><span class="hs-identifier hs-type">m</span></a><span>  </span><span class="hs-comment">-- ^ Generates a PLC 'Term' and the corresponding</span><span>
</span><a name="line-50"></a><span>                                               </span><span class="hs-comment">-- Haskell value out of a 'TypedBuiltin'.</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">-- | The type used in generators defined in this module.</span><span>
</span><a name="line-54"></a><span class="hs-comment">-- It's parameterized by a 'BuiltinGensT' which makes it possible to supply</span><span>
</span><a name="line-55"></a><span class="hs-comment">-- different generators of built-in types. For example, 'genTypedBuiltinDiv'</span><span>
</span><a name="line-56"></a><span class="hs-comment">-- never generates a zero, so this generator can be used in order to avoid the</span><span>
</span><a name="line-57"></a><span class="hs-comment">-- divide-by-zero exception. Supplied generators are of arbitrary complexity</span><span>
</span><a name="line-58"></a><span class="hs-comment">-- and can call the currently running generator recursively, for example.</span><span>
</span><a name="line-59"></a><span class="hs-keyword">type</span><span> </span><a name="PlcGenT"><a href="Language.PlutusCore.Generators.Internal.Entity.html#PlcGenT"><span class="hs-identifier">PlcGenT</span></a></a><span> </span><a name="local-6989586621679666987"><a href="#local-6989586621679666987"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ReaderT</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Generators.Internal.Entity.html#BuiltinGensT"><span class="hs-identifier hs-type">BuiltinGensT</span></a><span> </span><a href="#local-6989586621679666987"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679666987"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span class="hs-comment">-- | One iterated application of a @head@ to @arg@s represented in three distinct ways.</span><span>
</span><a name="line-62"></a><span class="hs-keyword">data</span><span> </span><a name="IterAppValue"><a href="Language.PlutusCore.Generators.Internal.Entity.html#IterAppValue"><span class="hs-identifier">IterAppValue</span></a></a><span> </span><a name="local-6989586621679666984"><a href="#local-6989586621679666984"><span class="hs-identifier">head</span></a></a><span> </span><a name="local-6989586621679666985"><a href="#local-6989586621679666985"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679666986"><a href="#local-6989586621679666986"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="IterAppValue"><a href="Language.PlutusCore.Generators.Internal.Entity.html#IterAppValue"><span class="hs-identifier">IterAppValue</span></a></a><span>
</span><a name="line-63"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="_iterTerm"><a href="Language.PlutusCore.Generators.Internal.Entity.html#_iterTerm"><span class="hs-identifier">_iterTerm</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- ^ As a PLC 'Term'.</span><span>
</span><a name="line-64"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_iterApp"><a href="Language.PlutusCore.Generators.Internal.Entity.html#_iterApp"><span class="hs-identifier">_iterApp</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.View.html#IterApp"><span class="hs-identifier hs-type">IterApp</span></a><span> </span><a href="#local-6989586621679666984"><span class="hs-identifier hs-type">head</span></a><span> </span><a href="#local-6989586621679666985"><span class="hs-identifier hs-type">arg</span></a><span>          </span><span class="hs-comment">-- ^ As an 'IterApp'.</span><span>
</span><a name="line-65"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_iterTbv"><a href="Language.PlutusCore.Generators.Internal.Entity.html#_iterTbv"><span class="hs-identifier">_iterTbv</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Constant.Typed.html#TypedBuiltinValue"><span class="hs-identifier hs-type">TypedBuiltinValue</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><a href="#local-6989586621679666986"><span class="hs-identifier hs-type">r</span></a><span>  </span><span class="hs-comment">-- ^ As a Haskell value.</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="PlutusPrelude.html#PrettyBy"><span class="hs-identifier hs-type">PrettyBy</span></a><span> </span><a href="#local-6989586621679666989"><span class="hs-identifier hs-type">config</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="PlutusPrelude.html#PrettyBy"><span class="hs-identifier hs-type">PrettyBy</span></a><span> </span><a href="#local-6989586621679666989"><span class="hs-identifier hs-type">config</span></a><span> </span><a href="#local-6989586621679666990"><span class="hs-identifier hs-type">head</span></a><span class="hs-special">,</span><span> </span><a href="PlutusPrelude.html#PrettyBy"><span class="hs-identifier hs-type">PrettyBy</span></a><span> </span><a href="#local-6989586621679666989"><span class="hs-identifier hs-type">config</span></a><span> </span><a href="#local-6989586621679666991"><span class="hs-identifier hs-type">arg</span></a><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Constant.Dynamic.Pretty.html#PrettyDynamic"><span class="hs-identifier hs-type">PrettyDynamic</span></a><span> </span><a href="#local-6989586621679666992"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-70"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="PlutusPrelude.html#PrettyBy"><span class="hs-identifier hs-type">PrettyBy</span></a><span> </span><a href="#local-6989586621679666989"><span class="hs-identifier hs-type">config</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Generators.Internal.Entity.html#IterAppValue"><span class="hs-identifier hs-type">IterAppValue</span></a><span> </span><a href="#local-6989586621679666990"><span class="hs-identifier hs-type">head</span></a><span> </span><a href="#local-6989586621679666991"><span class="hs-identifier hs-type">arg</span></a><span> </span><a href="#local-6989586621679666992"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-71"></a><span>    </span><a name="local-8214565720323854396"><a href="PlutusPrelude.html#prettyBy"><span class="hs-identifier">prettyBy</span></a></a><span> </span><a name="local-6989586621679666993"><a href="#local-6989586621679666993"><span class="hs-identifier">config</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Generators.Internal.Entity.html#IterAppValue"><span class="hs-identifier hs-var">IterAppValue</span></a><span> </span><a name="local-6989586621679666994"><a href="#local-6989586621679666994"><span class="hs-identifier">term</span></a></a><span> </span><a name="local-6989586621679666995"><a href="#local-6989586621679666995"><span class="hs-identifier">pia</span></a></a><span> </span><a name="local-6989586621679666996"><a href="#local-6989586621679666996"><span class="hs-identifier">tbv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parens</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fold</span><span>
</span><a name="line-72"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;{ &quot;</span><span class="hs-special">,</span><span> </span><a href="PlutusPrelude.html#prettyBy"><span class="hs-identifier hs-var">prettyBy</span></a><span> </span><a href="#local-6989586621679666993"><span class="hs-identifier hs-var">config</span></a><span> </span><a href="#local-6989586621679666994"><span class="hs-identifier hs-var">term</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">line</span><span>
</span><a name="line-73"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;| &quot;</span><span class="hs-special">,</span><span> </span><a href="PlutusPrelude.html#prettyBy"><span class="hs-identifier hs-var">prettyBy</span></a><span> </span><a href="#local-6989586621679666993"><span class="hs-identifier hs-var">config</span></a><span> </span><a href="#local-6989586621679666995"><span class="hs-identifier hs-var">pia</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">line</span><span>
</span><a name="line-74"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;| &quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pretty</span><span> </span><a href="#local-6989586621679666996"><span class="hs-identifier hs-var">tbv</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">line</span><span>
</span><a name="line-75"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;}&quot;</span><span>
</span><a name="line-76"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-comment">-- | Run a 'PlcGenT' computation by supplying built-ins generators.</span><span>
</span><a name="line-79"></a><span class="hs-identifier">runPlcT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679667022"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="#local-6989586621679667022"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TypedBuiltinGenT"><span class="hs-identifier hs-type">TypedBuiltinGenT</span></a><span> </span><a href="#local-6989586621679667022"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#PlcGenT"><span class="hs-identifier hs-type">PlcGenT</span></a><span> </span><a href="#local-6989586621679667022"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679667023"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="#local-6989586621679667022"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679667023"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-80"></a><a name="runPlcT"><a href="Language.PlutusCore.Generators.Internal.Entity.html#runPlcT"><span class="hs-identifier">runPlcT</span></a></a><span> </span><a name="local-6989586621679667024"><a href="#local-6989586621679667024"><span class="hs-identifier">genSize</span></a></a><span> </span><a name="local-6989586621679667025"><a href="#local-6989586621679667025"><span class="hs-identifier">genTb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Utils.html#hoistSupply"><span class="hs-identifier hs-var">hoistSupply</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#BuiltinGensT"><span class="hs-identifier hs-var">BuiltinGensT</span></a><span> </span><a href="#local-6989586621679667024"><span class="hs-identifier hs-var">genSize</span></a><span> </span><a href="#local-6989586621679667025"><span class="hs-identifier hs-var">genTb</span></a><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-comment">-- | Get a 'TermOf' out of an 'IterAppValue'.</span><span>
</span><a name="line-83"></a><span class="hs-identifier">iterAppValueToTermOf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#IterAppValue"><span class="hs-identifier hs-type">IterAppValue</span></a><span> </span><a href="#local-6989586621679667019"><span class="hs-identifier hs-type">head</span></a><span> </span><a href="#local-6989586621679667020"><span class="hs-identifier hs-type">arg</span></a><span> </span><a href="#local-6989586621679667021"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TermOf"><span class="hs-identifier hs-type">TermOf</span></a><span> </span><a href="#local-6989586621679667021"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-84"></a><a name="iterAppValueToTermOf"><a href="Language.PlutusCore.Generators.Internal.Entity.html#iterAppValueToTermOf"><span class="hs-identifier">iterAppValueToTermOf</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Generators.Internal.Entity.html#IterAppValue"><span class="hs-identifier hs-var">IterAppValue</span></a><span> </span><a name="local-6989586621679667026"><a href="#local-6989586621679667026"><span class="hs-identifier">term</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Constant.Typed.html#TypedBuiltinValue"><span class="hs-identifier hs-var">TypedBuiltinValue</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679667027"><a href="#local-6989586621679667027"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TermOf"><span class="hs-identifier hs-var">TermOf</span></a><span> </span><a href="#local-6989586621679667026"><span class="hs-identifier hs-var">term</span></a><span> </span><a href="#local-6989586621679667027"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- | Add to the 'ByteString' representation of a 'Name' its 'Unique'</span><span>
</span><a name="line-87"></a><span class="hs-comment">-- without any additional symbols inbetween.</span><span>
</span><a name="line-88"></a><span class="hs-identifier">revealUnique</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679667018"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679667018"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-89"></a><a name="revealUnique"><a href="Language.PlutusCore.Generators.Internal.Entity.html#revealUnique"><span class="hs-identifier">revealUnique</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><a name="local-6989586621679667028"><a href="#local-6989586621679667028"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621679667029"><a href="#local-6989586621679667029"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679667030"><a href="#local-6989586621679667030"><span class="hs-identifier">uniq</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-90"></a><span>    </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><a href="#local-6989586621679667028"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679667029"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-special">(</span><a href="PlutusPrelude.html#prettyText"><span class="hs-identifier hs-var">prettyText</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">unUnique</span><span> </span><a href="#local-6989586621679667030"><span class="hs-identifier hs-var">uniq</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679667030"><span class="hs-identifier hs-var">uniq</span></a><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-comment">-- | Generate a size from bounds.</span><span>
</span><a name="line-93"></a><span class="hs-identifier">genSizeIn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679667017"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="#local-6989586621679667017"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span>
</span><a name="line-94"></a><a name="genSizeIn"><a href="Language.PlutusCore.Generators.Internal.Entity.html#genSizeIn"><span class="hs-identifier">genSizeIn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Gen.integral</span><span> </span><span class="hs-operator hs-var">.*</span><span> </span><span class="hs-identifier hs-var">Range.linear</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-comment">-- | Generate a size using the default range of @[2..4]@.</span><span>
</span><a name="line-97"></a><span class="hs-identifier">genSizeDef</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679667016"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="#local-6989586621679667016"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span>
</span><a name="line-98"></a><a name="genSizeDef"><a href="Language.PlutusCore.Generators.Internal.Entity.html#genSizeDef"><span class="hs-identifier">genSizeDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genSizeIn"><span class="hs-identifier hs-var">genSizeIn</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-comment">-- | Either return a size taken from a 'TypedBuiltinSized' or generate one using 'genSizeDef'.</span><span>
</span><a name="line-101"></a><span class="hs-identifier">genSizeFrom</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679667014"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Constant.Typed.html#TypedBuiltin"><span class="hs-identifier hs-type">TypedBuiltin</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><a href="#local-6989586621679667015"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="#local-6989586621679667014"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span>
</span><a name="line-102"></a><a name="genSizeFrom"><a href="Language.PlutusCore.Generators.Internal.Entity.html#genSizeFrom"><span class="hs-identifier">genSizeFrom</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Constant.Typed.html#TypedBuiltinSized"><span class="hs-identifier hs-var">TypedBuiltinSized</span></a><span> </span><a name="local-6989586621679667031"><a href="#local-6989586621679667031"><span class="hs-identifier">sizeEntry</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Constant.Function.html#flattenSizeEntry"><span class="hs-identifier hs-var">flattenSizeEntry</span></a><span> </span><a href="#local-6989586621679667031"><span class="hs-identifier hs-var">sizeEntry</span></a><span>
</span><a name="line-103"></a><span class="hs-identifier">genSizeFrom</span><span> </span><span class="hs-identifier">_</span><span>                               </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genSizeDef"><span class="hs-identifier hs-var">genSizeDef</span></a><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">-- | Generate a 'BuiltinSized'.</span><span>
</span><a name="line-106"></a><span class="hs-identifier">genBuiltinSized</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679667013"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="#local-6989586621679667013"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Language.PlutusCore.Constant.Typed.html#BuiltinSized"><span class="hs-identifier hs-type">BuiltinSized</span></a><span>
</span><a name="line-107"></a><a name="genBuiltinSized"><a href="Language.PlutusCore.Generators.Internal.Entity.html#genBuiltinSized"><span class="hs-identifier">genBuiltinSized</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Gen.element</span><span> </span><span class="hs-special">[</span><a href="Language.PlutusCore.Constant.Typed.html#BuiltinSizedInt"><span class="hs-identifier hs-var">BuiltinSizedInt</span></a><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Constant.Typed.html#BuiltinSizedBS"><span class="hs-identifier hs-var">BuiltinSizedBS</span></a><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Constant.Typed.html#BuiltinSizedSize"><span class="hs-identifier hs-var">BuiltinSizedSize</span></a><span class="hs-special">]</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-comment">-- | Generate a 'Builtin'.</span><span>
</span><a name="line-110"></a><span class="hs-identifier">genBuiltin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679667011"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="#local-6989586621679667011"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="#local-6989586621679667011"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Constant.Typed.html#BuiltinType"><span class="hs-identifier hs-type">BuiltinType</span></a><span> </span><a href="#local-6989586621679667012"><span class="hs-identifier hs-type">size</span></a><span class="hs-special">)</span><span>
</span><a name="line-111"></a><a name="genBuiltin"><a href="Language.PlutusCore.Generators.Internal.Entity.html#genBuiltin"><span class="hs-identifier">genBuiltin</span></a></a><span> </span><a name="local-6989586621679667032"><a href="#local-6989586621679667032"><span class="hs-identifier">genSize</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Gen.choice</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="Language.PlutusCore.Constant.Typed.html#BuiltinSized"><span class="hs-identifier hs-var">BuiltinSized</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.PlutusCore.Constant.Typed.html#SizeValue"><span class="hs-identifier hs-var">SizeValue</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679667032"><span class="hs-identifier hs-var">genSize</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genBuiltinSized"><span class="hs-identifier hs-var">genBuiltinSized</span></a><span>
</span><a name="line-113"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="Language.PlutusCore.Constant.Typed.html#BuiltinBool"><span class="hs-identifier hs-var">BuiltinBool</span></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">-- | Generate a 'Builtin' and supply its typed version to a continuation.</span><span>
</span><a name="line-117"></a><span class="hs-identifier">withTypedBuiltinGen</span><span>
</span><a name="line-118"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679667007"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="#local-6989586621679667007"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679667010"><a href="#local-6989586621679667010"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><a href="Language.PlutusCore.Constant.Typed.html#TypedBuiltin"><span class="hs-identifier hs-type">TypedBuiltin</span></a><span> </span><a href="#local-6989586621679667008"><span class="hs-identifier hs-type">size</span></a><span> </span><a href="#local-6989586621679667010"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="#local-6989586621679667007"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679667009"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="#local-6989586621679667007"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679667009"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-119"></a><a name="withTypedBuiltinGen"><a href="Language.PlutusCore.Generators.Internal.Entity.html#withTypedBuiltinGen"><span class="hs-identifier">withTypedBuiltinGen</span></a></a><span> </span><a name="local-6989586621679667033"><a href="#local-6989586621679667033"><span class="hs-identifier">genSize</span></a></a><span> </span><a name="local-6989586621679667034"><a href="#local-6989586621679667034"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genBuiltin"><span class="hs-identifier hs-var">genBuiltin</span></a><span> </span><a href="#local-6989586621679667033"><span class="hs-identifier hs-var">genSize</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679667035"><a href="#local-6989586621679667035"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Constant.Function.html#withTypedBuiltin"><span class="hs-identifier hs-var">withTypedBuiltin</span></a><span> </span><a href="#local-6989586621679667035"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679667034"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">-- | Generate a 'Term' along with the value it computes to,</span><span>
</span><a name="line-122"></a><span class="hs-comment">-- having a generator of terms of built-in types.</span><span>
</span><a name="line-123"></a><span class="hs-identifier">withCheckedTermGen</span><span>
</span><a name="line-124"></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TypedBuiltinGenT"><span class="hs-identifier hs-type">TypedBuiltinGenT</span></a><span> </span><a href="Language.PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a><span>
</span><a name="line-125"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679667006"><a href="#local-6989586621679667006"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><a href="Language.PlutusCore.Constant.Typed.html#TypedBuiltin"><span class="hs-identifier hs-type">TypedBuiltin</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><a href="#local-6989586621679667006"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TermOf"><span class="hs-identifier hs-type">TermOf</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Value"><span class="hs-identifier hs-type">Value</span></a><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="Language.PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a><span> </span><a href="#local-6989586621679667005"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="Language.PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a><span> </span><a href="#local-6989586621679667005"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-127"></a><a name="withCheckedTermGen"><a href="Language.PlutusCore.Generators.Internal.Entity.html#withCheckedTermGen"><span class="hs-identifier">withCheckedTermGen</span></a></a><span> </span><a name="local-6989586621679667036"><a href="#local-6989586621679667036"><span class="hs-identifier">genTb</span></a></a><span> </span><a name="local-6989586621679667037"><a href="#local-6989586621679667037"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-128"></a><span>    </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#withTypedBuiltinGen"><span class="hs-identifier hs-var">withTypedBuiltinGen</span></a><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genSizeDef"><span class="hs-identifier hs-var">genSizeDef</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679667038"><a href="#local-6989586621679667038"><span class="hs-identifier">tb</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-129"></a><span>        </span><a name="local-6989586621679667039"><a href="#local-6989586621679667039"><span class="hs-identifier">termWithMetaValue</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679667036"><span class="hs-identifier hs-var">genTb</span></a><span> </span><a href="#local-6989586621679667038"><span class="hs-identifier hs-var">tb</span></a><span>
</span><a name="line-130"></a><span>        </span><a name="local-6989586621679667040"><a href="#local-6989586621679667040"><span class="hs-identifier">termWithValue</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-131"></a><span>            </span><a href="Language.PlutusCore.Quote.html#liftQuote"><span class="hs-identifier hs-var">liftQuote</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.PlutusCore.Generators.Internal.TypeEvalCheck.html#unsafeTypeEvalCheck"><span class="hs-identifier hs-var">unsafeTypeEvalCheck</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-132"></a><span>                </span><a href="Language.PlutusCore.Constant.Typed.html#TypedBuiltinValue"><span class="hs-identifier hs-var">TypedBuiltinValue</span></a><span> </span><a href="#local-6989586621679667038"><span class="hs-identifier hs-var">tb</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679667039"><span class="hs-identifier hs-var">termWithMetaValue</span></a><span>
</span><a name="line-133"></a><span>        </span><a href="#local-6989586621679667037"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679667038"><span class="hs-identifier hs-var">tb</span></a><span> </span><a href="#local-6989586621679667040"><span class="hs-identifier hs-var">termWithValue</span></a><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-- | Generate a 'TermOf' out of a 'TypeScheme'.</span><span>
</span><a name="line-136"></a><span class="hs-identifier">genSchemedTermOf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679667002"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Constant.Typed.html#TypeScheme"><span class="hs-identifier hs-type">TypeScheme</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><a href="#local-6989586621679667003"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679667004"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#PlcGenT"><span class="hs-identifier hs-type">PlcGenT</span></a><span> </span><a href="#local-6989586621679667002"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TermOf"><span class="hs-identifier hs-type">TermOf</span></a><span> </span><a href="#local-6989586621679667003"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-137"></a><a name="genSchemedTermOf"><a href="Language.PlutusCore.Generators.Internal.Entity.html#genSchemedTermOf"><span class="hs-identifier">genSchemedTermOf</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Constant.Typed.html#TypeSchemeBuiltin"><span class="hs-identifier hs-var">TypeSchemeBuiltin</span></a><span> </span><a name="local-6989586621679667041"><a href="#local-6989586621679667041"><span class="hs-identifier">tb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-138"></a><span>    </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#BuiltinGensT"><span class="hs-identifier hs-var">BuiltinGensT</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679667042"><a href="#local-6989586621679667042"><span class="hs-identifier">genTb</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">ask</span><span>
</span><a name="line-139"></a><span>    </span><a href="Language.PlutusCore.Generators.Internal.Utils.html#liftT"><span class="hs-identifier hs-var">liftT</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679667042"><span class="hs-identifier hs-var">genTb</span></a><span> </span><a href="#local-6989586621679667041"><span class="hs-identifier hs-var">tb</span></a><span>
</span><a name="line-140"></a><span class="hs-identifier">genSchemedTermOf</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Constant.Typed.html#TypeSchemeArrow"><span class="hs-identifier hs-var">TypeSchemeArrow</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Not implemented.&quot;</span><span>
</span><a name="line-141"></a><span class="hs-identifier">genSchemedTermOf</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Constant.Typed.html#TypeSchemeAllSize"><span class="hs-identifier hs-var">TypeSchemeAllSize</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Not implemented.&quot;</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-comment">-- | Generate an 'IterAppValue' from a 'Denotation'.</span><span>
</span><a name="line-144"></a><span class="hs-comment">-- If the 'Denotation' has a functional type, then all arguments are generated and</span><span>
</span><a name="line-145"></a><span class="hs-comment">-- supplied to the denotation, the resulting value is forced and if there are any exceptions,</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- then all generated arguments are discarded and another attempt is performed</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- (this process does not loop). Since 'IterAppValue' consists of three components, we</span><span>
</span><a name="line-148"></a><span class="hs-comment">--   1. grow the 'Term' component by applying it to arguments using 'Apply'</span><span>
</span><a name="line-149"></a><span class="hs-comment">--   2. grow the 'IterApp' component by appending arguments to its spine</span><span>
</span><a name="line-150"></a><span class="hs-comment">--   3. feed arguments to the Haskell function</span><span>
</span><a name="line-151"></a><span class="hs-identifier">genIterAppValue</span><span>
</span><a name="line-152"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679666999"><a href="#local-6989586621679666999"><span class="hs-identifier">head</span></a></a><span> </span><a name="local-6989586621679667000"><a href="#local-6989586621679667000"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679667001"><a href="#local-6989586621679667001"><span class="hs-identifier">m</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679667001"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-153"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Denotation.html#Denotation"><span class="hs-identifier hs-type">Denotation</span></a><span> </span><a href="#local-6989586621679666999"><span class="hs-identifier hs-type">head</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><a href="#local-6989586621679667000"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-154"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#PlcGenT"><span class="hs-identifier hs-type">PlcGenT</span></a><span> </span><a href="#local-6989586621679667001"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Generators.Internal.Entity.html#IterAppValue"><span class="hs-identifier hs-type">IterAppValue</span></a><span> </span><a href="#local-6989586621679666999"><span class="hs-identifier hs-type">head</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679667000"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-155"></a><a name="genIterAppValue"><a href="Language.PlutusCore.Generators.Internal.Entity.html#genIterAppValue"><span class="hs-identifier">genIterAppValue</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Generators.Internal.Denotation.html#Denotation"><span class="hs-identifier hs-var">Denotation</span></a><span> </span><a name="local-6989586621679667043"><a href="#local-6989586621679667043"><span class="hs-identifier">object</span></a></a><span> </span><a name="local-6989586621679667044"><a href="#local-6989586621679667044"><span class="hs-identifier">toTerm</span></a></a><span> </span><a name="local-6989586621679667045"><a href="#local-6989586621679667045"><span class="hs-identifier">meta</span></a></a><span> </span><a name="local-6989586621679667046"><a href="#local-6989586621679667046"><span class="hs-identifier">scheme</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679667047"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-156"></a><span>    </span><a name="local-6989586621679667047"><a href="#local-6989586621679667047"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Gen.just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679667048"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679667046"><span class="hs-identifier hs-var">scheme</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679667044"><span class="hs-identifier hs-var">toTerm</span></a><span> </span><a href="#local-6989586621679667043"><span class="hs-identifier hs-var">object</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><a href="#local-6989586621679667045"><span class="hs-identifier hs-var">meta</span></a><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span>    </span><span class="hs-identifier">go</span><span>
</span><a name="line-159"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Constant.Typed.html#TypeScheme"><span class="hs-identifier hs-type">TypeScheme</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><a href="#local-6989586621679667049"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679667000"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-160"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679667049"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-163"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#PlcGenT"><span class="hs-identifier hs-type">PlcGenT</span></a><span> </span><a href="#local-6989586621679667001"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Generators.Internal.Entity.html#IterAppValue"><span class="hs-identifier hs-type">IterAppValue</span></a><span> </span><a href="#local-6989586621679666999"><span class="hs-identifier hs-type">head</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679667000"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span>    </span><a name="local-6989586621679667048"><a href="#local-6989586621679667048"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Constant.Typed.html#TypeSchemeBuiltin"><span class="hs-identifier hs-var">TypeSchemeBuiltin</span></a><span> </span><a name="local-6989586621679667050"><a href="#local-6989586621679667050"><span class="hs-identifier">builtin</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679667051"><a href="#local-6989586621679667051"><span class="hs-identifier">term</span></a></a><span> </span><a name="local-6989586621679667052"><a href="#local-6989586621679667052"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621679667053"><a href="#local-6989586621679667053"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span>     </span><span class="hs-comment">-- Computed the result.</span><span>
</span><a name="line-165"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">tryAny</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">evaluate</span><span> </span><a href="#local-6989586621679667053"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-166"></a><span>            </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-167"></a><span>            </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679667054"><a href="#local-6989586621679667054"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-168"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679667055"><a href="#local-6989586621679667055"><span class="hs-identifier">pia</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.View.html#IterApp"><span class="hs-identifier hs-var">IterApp</span></a><span> </span><a href="#local-6989586621679667043"><span class="hs-identifier hs-var">object</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679667052"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-169"></a><span>                    </span><a name="local-6989586621679667056"><a href="#local-6989586621679667056"><span class="hs-identifier">tbv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Constant.Typed.html#TypedBuiltinValue"><span class="hs-identifier hs-var">TypedBuiltinValue</span></a><span> </span><a href="#local-6989586621679667050"><span class="hs-identifier hs-var">builtin</span></a><span> </span><a href="#local-6989586621679667054"><span class="hs-identifier hs-var">y'</span></a><span>
</span><a name="line-170"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#IterAppValue"><span class="hs-identifier hs-var">IterAppValue</span></a><span> </span><a href="#local-6989586621679667051"><span class="hs-identifier hs-var">term</span></a><span> </span><a href="#local-6989586621679667055"><span class="hs-identifier hs-var">pia</span></a><span> </span><a href="#local-6989586621679667056"><span class="hs-identifier hs-var">tbv</span></a><span>
</span><a name="line-171"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Constant.Typed.html#TypeSchemeArrow"><span class="hs-identifier hs-var">TypeSchemeArrow</span></a><span> </span><a name="local-6989586621679667057"><a href="#local-6989586621679667057"><span class="hs-identifier">schA</span></a></a><span> </span><a name="local-6989586621679667058"><a href="#local-6989586621679667058"><span class="hs-identifier">schB</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679667059"><a href="#local-6989586621679667059"><span class="hs-identifier">term</span></a></a><span> </span><a name="local-6989586621679667060"><a href="#local-6989586621679667060"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621679667061"><a href="#local-6989586621679667061"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-comment">-- Another argument is required.</span><span>
</span><a name="line-172"></a><span>        </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TermOf"><span class="hs-identifier hs-var">TermOf</span></a><span> </span><a name="local-6989586621679667062"><a href="#local-6989586621679667062"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679667063"><a href="#local-6989586621679667063"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genSchemedTermOf"><span class="hs-identifier hs-var">genSchemedTermOf</span></a><span> </span><a href="#local-6989586621679667057"><span class="hs-identifier hs-var">schA</span></a><span>          </span><span class="hs-comment">-- Get a Haskell and the correspoding PLC values.</span><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679667064"><a href="#local-6989586621679667064"><span class="hs-identifier">term'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#Apply"><span class="hs-identifier hs-var">Apply</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679667059"><span class="hs-identifier hs-var">term</span></a><span> </span><a href="#local-6989586621679667062"><span class="hs-identifier hs-var">v</span></a><span>                  </span><span class="hs-comment">-- Apply the term to the PLC value.</span><span>
</span><a name="line-175"></a><span>            </span><a name="local-6989586621679667065"><a href="#local-6989586621679667065"><span class="hs-identifier">args'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679667060"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679667062"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>                     </span><span class="hs-comment">-- Append the PLC value to the spine.</span><span>
</span><a name="line-176"></a><span>            </span><a name="local-6989586621679667066"><a href="#local-6989586621679667066"><span class="hs-identifier">y</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679667061"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679667063"><span class="hs-identifier hs-var">x</span></a><span>                              </span><span class="hs-comment">-- Apply the Haskell function to the generated argument.</span><span>
</span><a name="line-177"></a><span>        </span><a href="#local-6989586621679667048"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679667058"><span class="hs-identifier hs-var">schB</span></a><span> </span><a href="#local-6989586621679667064"><span class="hs-identifier hs-var">term'</span></a><span> </span><a href="#local-6989586621679667065"><span class="hs-identifier hs-var">args'</span></a><span> </span><a href="#local-6989586621679667066"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-178"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Constant.Typed.html#TypeSchemeAllSize"><span class="hs-identifier hs-var">TypeSchemeAllSize</span></a><span> </span><a name="local-6989586621679667067"><a href="#local-6989586621679667067"><span class="hs-identifier">schK</span></a></a><span class="hs-special">)</span><span>    </span><a name="local-6989586621679667068"><a href="#local-6989586621679667068"><span class="hs-identifier">term</span></a></a><span> </span><a name="local-6989586621679667069"><a href="#local-6989586621679667069"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621679667070"><a href="#local-6989586621679667070"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-179"></a><span>        </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#BuiltinGensT"><span class="hs-identifier hs-var">BuiltinGensT</span></a><span> </span><a name="local-6989586621679667071"><a href="#local-6989586621679667071"><span class="hs-identifier">genSize</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">ask</span><span>
</span><a name="line-180"></a><span>        </span><a name="local-6989586621679667072"><a href="#local-6989586621679667072"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Utils.html#liftT"><span class="hs-identifier hs-var">liftT</span></a><span> </span><a href="#local-6989586621679667071"><span class="hs-identifier hs-var">genSize</span></a><span>                        </span><span class="hs-comment">-- Generate a size.</span><span>
</span><a name="line-181"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679667073"><a href="#local-6989586621679667073"><span class="hs-identifier">term'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#TyInst"><span class="hs-identifier hs-var">TyInst</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679667068"><span class="hs-identifier hs-var">term</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Type.html#TyInt"><span class="hs-identifier hs-var">TyInt</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679667072"><span class="hs-identifier hs-var">size</span></a><span>   </span><span class="hs-comment">-- Instantiate the term with the generated size.</span><span>
</span><a name="line-182"></a><span>        </span><a href="#local-6989586621679667048"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679667067"><span class="hs-identifier hs-var">schK</span></a><span> </span><a href="#local-6989586621679667072"><span class="hs-identifier hs-var">size</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679667073"><span class="hs-identifier hs-var">term'</span></a><span> </span><a href="#local-6989586621679667069"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621679667070"><span class="hs-identifier hs-var">f</span></a><span>                  </span><span class="hs-comment">-- Instantiate a size variable with the generated size.</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">-- | Generate a PLC 'Term' of the specified type and the corresponding Haskell value.</span><span>
</span><a name="line-185"></a><span class="hs-comment">-- Generates first-order functions and constants including constant applications.</span><span>
</span><a name="line-186"></a><span class="hs-comment">-- Arguments to functions and 'BuiltinName's are generated recursively.</span><span>
</span><a name="line-187"></a><span class="hs-identifier">genTerm</span><span>
</span><a name="line-188"></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TypedBuiltinGenT"><span class="hs-identifier hs-type">TypedBuiltinGenT</span></a><span> </span><a href="Language.PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a><span>  </span><span class="hs-comment">-- ^ Ground generators of built-ins. The base case of the recursion.</span><span>
</span><a name="line-189"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Denotation.html#DenotationContext"><span class="hs-identifier hs-type">DenotationContext</span></a><span>       </span><span class="hs-comment">-- ^ A context to generate terms in. See for example 'typedBuiltinNames'.</span><span>
</span><a name="line-190"></a><span>                               </span><span class="hs-comment">-- Gets extended by a variable when an applied lambda is generated.</span><span>
</span><a name="line-191"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>                     </span><span class="hs-comment">-- ^ Depth of recursion.</span><span>
</span><a name="line-192"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TypedBuiltinGenT"><span class="hs-identifier hs-type">TypedBuiltinGenT</span></a><span> </span><a href="Language.PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a><span>
</span><a name="line-193"></a><a name="genTerm"><a href="Language.PlutusCore.Generators.Internal.Entity.html#genTerm"><span class="hs-identifier">genTerm</span></a></a><span> </span><a name="local-6989586621679667074"><a href="#local-6989586621679667074"><span class="hs-identifier">genBase</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679667075"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-194"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Denotation.html#DenotationContext"><span class="hs-identifier hs-type">DenotationContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Constant.Typed.html#TypedBuiltin"><span class="hs-identifier hs-type">TypedBuiltin</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><a href="#local-6989586621679667076"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="Language.PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TermOf"><span class="hs-identifier hs-type">TermOf</span></a><span> </span><a href="#local-6989586621679667076"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span>    </span><a name="local-6989586621679667075"><a href="#local-6989586621679667075"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679667077"><a href="#local-6989586621679667077"><span class="hs-identifier">context</span></a></a><span> </span><a name="local-6989586621679667078"><a href="#local-6989586621679667078"><span class="hs-identifier">depth</span></a></a><span> </span><a name="local-6989586621679667079"><a href="#local-6989586621679667079"><span class="hs-identifier">tb</span></a></a><span>
</span><a name="line-196"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679667078"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Utils.html#choiceDef"><span class="hs-identifier hs-var">choiceDef</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679667074"><span class="hs-identifier hs-var">genBase</span></a><span> </span><a href="#local-6989586621679667079"><span class="hs-identifier hs-var">tb</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679667085"><span class="hs-identifier hs-var">variables</span></a><span>
</span><a name="line-197"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679667078"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Utils.html#choiceDef"><span class="hs-identifier hs-var">choiceDef</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679667074"><span class="hs-identifier hs-var">genBase</span></a><span> </span><a href="#local-6989586621679667079"><span class="hs-identifier hs-var">tb</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679667085"><span class="hs-identifier hs-var">variables</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679667086"><span class="hs-identifier hs-var">recursive</span></a><span>
</span><a name="line-198"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679667078"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Gen.choice</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679667087"><span class="hs-identifier hs-var">lambdaApply</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679667085"><span class="hs-identifier hs-var">variables</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679667086"><span class="hs-identifier hs-var">recursive</span></a><span>
</span><a name="line-199"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679667078"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Gen.choice</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679667087"><span class="hs-identifier hs-var">lambdaApply</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679667086"><span class="hs-identifier hs-var">recursive</span></a><span>
</span><a name="line-200"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679667087"><span class="hs-identifier hs-var">lambdaApply</span></a><span>
</span><a name="line-201"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-202"></a><span>            </span><span class="hs-comment">-- Instantiate all size variables with '()'.</span><span>
</span><a name="line-203"></a><span>            </span><a name="local-6989586621679667080"><a href="#local-6989586621679667080"><span class="hs-identifier">desizedTb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Constant.Function.html#mapSizeEntryTypedBuiltin"><span class="hs-identifier hs-var">mapSizeEntryTypedBuiltin</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Constant.Typed.html#SizeBound"><span class="hs-identifier hs-var">SizeBound</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679667079"><span class="hs-identifier hs-var">tb</span></a><span>
</span><a name="line-204"></a><span>            </span><span class="hs-comment">-- Generators of built-ins to feed them to 'genIterAppValue'.</span><span>
</span><a name="line-205"></a><span>            </span><span class="hs-comment">-- Note that we currently generate the same size over and over again (see 'genSizeFrom').</span><span>
</span><a name="line-206"></a><span>            </span><span class="hs-comment">-- We could also generate distinct sizes and use 'ResizeInteger'. That's a TODO probably.</span><span>
</span><a name="line-207"></a><span>            </span><span class="hs-comment">-- We could do unification and generate sizes for uninstantiate variables.</span><span>
</span><a name="line-208"></a><span>            </span><span class="hs-comment">-- That would be cool, but it's not trivial.</span><span>
</span><a name="line-209"></a><span>            </span><span class="hs-comment">-- Generating size variables would be nice too, but that's way too complicated.</span><span>
</span><a name="line-210"></a><span>            </span><span class="hs-comment">-- Note that the typed built-ins generator calls 'go' recursively.</span><span>
</span><a name="line-211"></a><span>            </span><a name="local-6989586621679667081"><a href="#local-6989586621679667081"><span class="hs-identifier">genSize</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genSizeFrom"><span class="hs-identifier hs-var">genSizeFrom</span></a><span> </span><a href="#local-6989586621679667079"><span class="hs-identifier hs-var">tb</span></a><span>
</span><a name="line-212"></a><span>            </span><a name="local-6989586621679667082"><a href="#local-6989586621679667082"><span class="hs-identifier">builtinGens</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#BuiltinGensT"><span class="hs-identifier hs-var">BuiltinGensT</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genSizeFrom"><span class="hs-identifier hs-var">genSizeFrom</span></a><span> </span><a href="#local-6989586621679667079"><span class="hs-identifier hs-var">tb</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">Gen.subterm</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679667075"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679667077"><span class="hs-identifier hs-var">context</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679667078"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-213"></a><span>            </span><span class="hs-comment">-- Generate arguments for functions recursively or return a variable.</span><span>
</span><a name="line-214"></a><span>            </span><a name="local-6989586621679667083"><a href="#local-6989586621679667083"><span class="hs-identifier">proceed</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Generators.Internal.Denotation.html#DenotationContextMember"><span class="hs-identifier hs-var">DenotationContextMember</span></a><span> </span><a name="local-6989586621679667088"><a href="#local-6989586621679667088"><span class="hs-identifier">denotation</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-215"></a><span>                </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#iterAppValueToTermOf"><span class="hs-identifier hs-var">iterAppValueToTermOf</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Utils.html#hoistSupply"><span class="hs-identifier hs-var">hoistSupply</span></a><span> </span><a href="#local-6989586621679667082"><span class="hs-identifier hs-var">builtinGens</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genIterAppValue"><span class="hs-identifier hs-var">genIterAppValue</span></a><span> </span><a href="#local-6989586621679667088"><span class="hs-identifier hs-var">denotation</span></a><span>
</span><a name="line-216"></a><span>            </span><span class="hs-comment">-- Look up a list of 'Denotation's from 'DenotationContext' each of which</span><span>
</span><a name="line-217"></a><span>            </span><span class="hs-comment">-- has a type that ends in the same type as the one that 'tb\'' represents.</span><span>
</span><a name="line-218"></a><span>            </span><a name="local-6989586621679667084"><a href="#local-6989586621679667084"><span class="hs-identifier">lookupInContext</span></a></a><span> </span><a name="local-6989586621679667089"><a href="#local-6989586621679667089"><span class="hs-identifier">tb'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-identifier">getCompose</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">DMap.lookup</span><span> </span><a href="#local-6989586621679667089"><span class="hs-identifier hs-var">tb'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">unDenotationContext</span><span> </span><a href="#local-6989586621679667077"><span class="hs-identifier hs-var">context</span></a><span>
</span><a name="line-219"></a><span>            </span><span class="hs-comment">-- A list of variables generators.</span><span>
</span><a name="line-220"></a><span>            </span><a name="local-6989586621679667085"><a href="#local-6989586621679667085"><span class="hs-identifier">variables</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679667083"><span class="hs-identifier hs-var">proceed</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679667084"><span class="hs-identifier hs-var">lookupInContext</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Constant.Function.html#closeTypedBuiltin"><span class="hs-identifier hs-var">closeTypedBuiltin</span></a><span> </span><a href="#local-6989586621679667079"><span class="hs-identifier hs-var">tb</span></a><span>
</span><a name="line-221"></a><span>            </span><span class="hs-comment">-- A list of recursive generators. We use 'desizedTb' instead of just 'tb'</span><span>
</span><a name="line-222"></a><span>            </span><span class="hs-comment">-- in order to make e.g. 'integer 2' unifiable with 'integer s' for universally</span><span>
</span><a name="line-223"></a><span>            </span><span class="hs-comment">-- quantified 's'. For this we simply instantiate all variables with '()' in</span><span>
</span><a name="line-224"></a><span>            </span><span class="hs-comment">-- the type, a term of which we're currently generating, and look that type up in</span><span>
</span><a name="line-225"></a><span>            </span><span class="hs-comment">-- the current context where universally quantified variable are already</span><span>
</span><a name="line-226"></a><span>            </span><span class="hs-comment">-- instantiate to '()' (which happens at the insertion phase, see 'insertTypedBuiltinName')</span><span>
</span><a name="line-227"></a><span>            </span><a name="local-6989586621679667086"><a href="#local-6989586621679667086"><span class="hs-identifier">recursive</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679667083"><span class="hs-identifier hs-var">proceed</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679667084"><span class="hs-identifier hs-var">lookupInContext</span></a><span> </span><a href="#local-6989586621679667080"><span class="hs-identifier hs-var">desizedTb</span></a><span>
</span><a name="line-228"></a><span>            </span><span class="hs-comment">-- Generate a lambda and immediately apply it to a generated argument of a generated type.</span><span>
</span><a name="line-229"></a><span>            </span><a name="local-6989586621679667087"><a href="#local-6989586621679667087"><span class="hs-identifier">lambdaApply</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#withTypedBuiltinGen"><span class="hs-identifier hs-var">withTypedBuiltinGen</span></a><span> </span><a href="#local-6989586621679667081"><span class="hs-identifier hs-var">genSize</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679667090"><a href="#local-6989586621679667090"><span class="hs-identifier">argTb</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-230"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679667091"><a href="#local-6989586621679667091"><span class="hs-identifier">argTyTb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Constant.Function.html#mapSizeTypedBuiltin"><span class="hs-identifier hs-var">mapSizeTypedBuiltin</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Type.html#TyBuiltin"><span class="hs-identifier hs-var">TyBuiltin</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="Language.PlutusCore.Lexer.Type.html#TySize"><span class="hs-identifier hs-var">TySize</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679667090"><span class="hs-identifier hs-var">argTb</span></a><span>
</span><a name="line-231"></a><span>                </span><span class="hs-comment">-- Generate a name for the name representing the argument.</span><span>
</span><a name="line-232"></a><span>                </span><a name="local-6989586621679667092"><a href="#local-6989586621679667092"><span class="hs-identifier">name</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#revealUnique"><span class="hs-identifier hs-var">revealUnique</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#freshName"><span class="hs-identifier hs-var">freshName</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;x&quot;</span><span>
</span><a name="line-233"></a><span>                </span><span class="hs-comment">-- Get the 'Type' of the argument from a generated 'TypedBuiltin'.</span><span>
</span><a name="line-234"></a><span>                </span><a name="local-6989586621679667093"><a href="#local-6989586621679667093"><span class="hs-identifier">argTy</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Constant.Function.html#typedBuiltinToType"><span class="hs-identifier hs-var">typedBuiltinToType</span></a><span> </span><a href="#local-6989586621679667091"><span class="hs-identifier hs-var">argTyTb</span></a><span>
</span><a name="line-235"></a><span>                </span><span class="hs-comment">-- Generate the argument.</span><span>
</span><a name="line-236"></a><span>                </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TermOf"><span class="hs-identifier hs-var">TermOf</span></a><span> </span><a name="local-6989586621679667094"><a href="#local-6989586621679667094"><span class="hs-identifier">arg</span></a></a><span>  </span><a name="local-6989586621679667095"><a href="#local-6989586621679667095"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679667075"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679667077"><span class="hs-identifier hs-var">context</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679667078"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679667090"><span class="hs-identifier hs-var">argTb</span></a><span>
</span><a name="line-237"></a><span>                </span><span class="hs-comment">-- Generate the body of the lambda abstraction adding the new variable to the context.</span><span>
</span><a name="line-238"></a><span>                </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TermOf"><span class="hs-identifier hs-var">TermOf</span></a><span> </span><a name="local-6989586621679667096"><a href="#local-6989586621679667096"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-6989586621679667097"><a href="#local-6989586621679667097"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679667075"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Generators.Internal.Denotation.html#insertVariable"><span class="hs-identifier hs-var">insertVariable</span></a><span> </span><a href="#local-6989586621679667092"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679667090"><span class="hs-identifier hs-var">argTb</span></a><span> </span><a href="#local-6989586621679667095"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679667077"><span class="hs-identifier hs-var">context</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679667078"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679667079"><span class="hs-identifier hs-var">tb</span></a><span>
</span><a name="line-239"></a><span>                </span><span class="hs-comment">-- Assemble the term.</span><span>
</span><a name="line-240"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679667098"><a href="#local-6989586621679667098"><span class="hs-identifier">term</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#Apply"><span class="hs-identifier hs-var">Apply</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#LamAbs"><span class="hs-identifier hs-var">LamAbs</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679667092"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679667093"><span class="hs-identifier hs-var">argTy</span></a><span> </span><a href="#local-6989586621679667096"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679667094"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-241"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TermOf"><span class="hs-identifier hs-var">TermOf</span></a><span> </span><a href="#local-6989586621679667098"><span class="hs-identifier hs-var">term</span></a><span> </span><a href="#local-6989586621679667097"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span class="hs-comment">-- | Generates a 'Term' with rather small values to make out-of-bounds failures less likely.</span><span>
</span><a name="line-244"></a><span class="hs-comment">-- There are still like a half of terms that fail with out-of-bounds errors being evaluated.</span><span>
</span><a name="line-245"></a><span class="hs-identifier">genTermLoose</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TypedBuiltinGenT"><span class="hs-identifier hs-type">TypedBuiltinGenT</span></a><span> </span><a href="Language.PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a><span>
</span><a name="line-246"></a><a name="genTermLoose"><a href="Language.PlutusCore.Generators.Internal.Entity.html#genTermLoose"><span class="hs-identifier">genTermLoose</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genTerm"><span class="hs-identifier hs-var">genTerm</span></a><span> </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#genTypedBuiltinSmall"><span class="hs-identifier hs-var">genTypedBuiltinSmall</span></a><span> </span><a href="Language.PlutusCore.Generators.Internal.Denotation.html#typedBuiltinNames"><span class="hs-identifier hs-var">typedBuiltinNames</span></a><span> </span><span class="hs-number">4</span><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span class="hs-comment">-- | Generate a 'TypedBuiltin' and a 'TermOf' of the corresponding type,</span><span>
</span><a name="line-249"></a><span class="hs-comment">-- attach the 'TypedBuiltin' to the value part of the 'TermOf' and pass that to a continuation.</span><span>
</span><a name="line-250"></a><span class="hs-identifier">withAnyTermLoose</span><span>
</span><a name="line-251"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679666998"><a href="#local-6989586621679666998"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><a href="Language.PlutusCore.Generators.Internal.TypedBuiltinGen.html#TermOf"><span class="hs-identifier hs-type">TermOf</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Constant.Typed.html#TypedBuiltinValue"><span class="hs-identifier hs-type">TypedBuiltinValue</span></a><span> </span><a href="Language.PlutusCore.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><a href="#local-6989586621679666998"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="Language.PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a><span> </span><a href="#local-6989586621679666997"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="Language.PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a><span> </span><a href="#local-6989586621679666997"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-252"></a><a name="withAnyTermLoose"><a href="Language.PlutusCore.Generators.Internal.Entity.html#withAnyTermLoose"><span class="hs-identifier">withAnyTermLoose</span></a></a><span> </span><a name="local-6989586621679667099"><a href="#local-6989586621679667099"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-253"></a><span>    </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#withTypedBuiltinGen"><span class="hs-identifier hs-var">withTypedBuiltinGen</span></a><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genSizeDef"><span class="hs-identifier hs-var">genSizeDef</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679667100"><a href="#local-6989586621679667100"><span class="hs-identifier">tb</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Generators.Internal.Entity.html#genTermLoose"><span class="hs-identifier hs-var">genTermLoose</span></a><span> </span><a href="#local-6989586621679667100"><span class="hs-identifier hs-var">tb</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="#local-6989586621679667099"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Constant.Typed.html#TypedBuiltinValue"><span class="hs-identifier hs-var">TypedBuiltinValue</span></a><span> </span><a href="#local-6989586621679667100"><span class="hs-identifier hs-var">tb</span></a><span class="hs-special">)</span><span>
</span><a name="line-254"></a></pre></body></html>