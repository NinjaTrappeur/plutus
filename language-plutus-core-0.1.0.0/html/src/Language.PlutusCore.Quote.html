<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DefaultSignatures     #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE LambdaCase            #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- just for the type equality constraint</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE GADTs                 #-}</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.PlutusCore.Quote</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-9"></a><span>              </span><a href="Language.PlutusCore.Quote.html#runQuoteT"><span class="hs-identifier hs-var">runQuoteT</span></a><span>
</span><a name="line-10"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#runQuote"><span class="hs-identifier hs-var">runQuote</span></a><span>
</span><a name="line-11"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#freshUnique"><span class="hs-identifier hs-var">freshUnique</span></a><span>
</span><a name="line-12"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#freshName"><span class="hs-identifier hs-var">freshName</span></a><span>
</span><a name="line-13"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#freshTyName"><span class="hs-identifier hs-var">freshTyName</span></a><span>
</span><a name="line-14"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#freshenName"><span class="hs-identifier hs-var">freshenName</span></a><span>
</span><a name="line-15"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#freshenTyName"><span class="hs-identifier hs-var">freshenTyName</span></a><span>
</span><a name="line-16"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#markNonFresh"><span class="hs-identifier hs-var">markNonFresh</span></a><span>
</span><a name="line-17"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#markNonFreshTerm"><span class="hs-identifier hs-var">markNonFreshTerm</span></a><span>
</span><a name="line-18"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#markNonFreshType"><span class="hs-identifier hs-var">markNonFreshType</span></a><span>
</span><a name="line-19"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#markNonFreshProgram"><span class="hs-identifier hs-var">markNonFreshProgram</span></a><span>
</span><a name="line-20"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#QuoteT"><span class="hs-identifier hs-type">QuoteT</span></a><span>
</span><a name="line-21"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a><span>
</span><a name="line-22"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span>
</span><a name="line-23"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#FreshState"><span class="hs-identifier hs-type">FreshState</span></a><span>
</span><a name="line-24"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#liftQuote"><span class="hs-identifier hs-var">liftQuote</span></a><span>
</span><a name="line-25"></a><span>            </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Lens</span><span>              </span><span class="hs-special">(</span><span class="hs-identifier hs-var">coerced</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Monad.Except</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Monad.Morph</span><span>       </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">MM</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Monad.Reader</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Monad.State</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Monad.Trans.Maybe</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Functor.Foldable</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Functor.Identity</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span>                  </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text</span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Text</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Hedgehog</span><span>                  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GenT</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PropertyT</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.PlutusCore.Name.html"><span class="hs-identifier">Language.PlutusCore.Name</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.PlutusCore.Type.html"><span class="hs-identifier">Language.PlutusCore.Type</span></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span>           </span><a href="PlutusPrelude.html"><span class="hs-identifier">PlutusPrelude</span></a><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">-- | The state contains the &quot;next&quot; 'Unique' that should be used for a name</span><span>
</span><a name="line-45"></a><span class="hs-keyword">type</span><span> </span><a name="FreshState"><a href="Language.PlutusCore.Quote.html#FreshState"><span class="hs-identifier">FreshState</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Name.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-identifier">emptyFreshState</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Quote.html#FreshState"><span class="hs-identifier hs-type">FreshState</span></a><span>
</span><a name="line-48"></a><a name="emptyFreshState"><a href="Language.PlutusCore.Quote.html#emptyFreshState"><span class="hs-identifier">emptyFreshState</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Name.html#Unique"><span class="hs-identifier hs-var">Unique</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">-- | The &quot;quotation&quot; monad transformer. Within this monad you can do safe construction of PLC terms using quasiquotation,</span><span>
</span><a name="line-51"></a><span class="hs-comment">-- fresh-name generation, and parsing.</span><span>
</span><a name="line-52"></a><span class="hs-keyword">newtype</span><span> </span><a name="QuoteT"><a href="Language.PlutusCore.Quote.html#QuoteT"><span class="hs-identifier">QuoteT</span></a></a><span> </span><a name="local-6989586621679251676"><a href="#local-6989586621679251676"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679251677"><a href="#local-6989586621679251677"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="QuoteT"><a href="Language.PlutusCore.Quote.html#QuoteT"><span class="hs-identifier">QuoteT</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unQuoteT"><a href="Language.PlutusCore.Quote.html#unQuoteT"><span class="hs-identifier">unQuoteT</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">StateT</span><span> </span><a href="Language.PlutusCore.Quote.html#FreshState"><span class="hs-identifier hs-type">FreshState</span></a><span> </span><a href="#local-6989586621679251676"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679251677"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-53"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadTrans</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MM.MFunctor</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="Language.PlutusCore.Quote.html#FreshState"><span class="hs-identifier hs-type">FreshState</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadError</span><span> </span><a href="#local-6989586621679251678"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadReader</span><span> </span><a href="#local-6989586621679251797"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-comment">-- | A monad that allows lifting of quoted expressions.</span><span>
</span><a name="line-56"></a><span class="hs-keyword">class</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679251650"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="MonadQuote"><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier">MonadQuote</span></a></a><span> </span><a name="local-6989586621679251650"><a href="#local-6989586621679251650"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-57"></a><span>    </span><a name="liftQuote"><a href="Language.PlutusCore.Quote.html#liftQuote"><span class="hs-identifier">liftQuote</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a><span> </span><a href="#local-6989586621679251651"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679251650"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679251651"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-58"></a><span>    </span><span class="hs-comment">-- This means we don't have to implement it when we're writing an instance for a MonadTrans monad. We can't just</span><span>
</span><a name="line-59"></a><span>    </span><span class="hs-comment">-- add an instance declaration for that, because it overlaps with the base instance.</span><span>
</span><a name="line-60"></a><span>    </span><span class="hs-keyword">default</span><span> </span><a name="liftQuote"><a href="Language.PlutusCore.Quote.html#liftQuote"><span class="hs-identifier">liftQuote</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><a href="#local-6989586621679251652"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadTrans</span><span> </span><a href="#local-6989586621679251653"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">t</span><span> </span><a href="#local-6989586621679251652"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="#local-6989586621679251650"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a><span> </span><a href="#local-6989586621679251654"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679251650"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679251654"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-61"></a><span>    </span><a name="local-8214565720324026542"><a href="Language.PlutusCore.Quote.html#liftQuote"><span class="hs-identifier">liftQuote</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.PlutusCore.Quote.html#liftQuote"><span class="hs-identifier hs-var">liftQuote</span></a><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679251807"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Quote.html#QuoteT"><span class="hs-identifier hs-type">QuoteT</span></a><span> </span><a href="#local-6989586621679251807"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-64"></a><span>    </span><a name="local-8214565720324026542"><a href="Language.PlutusCore.Quote.html#liftQuote"><span class="hs-identifier">liftQuote</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">MM.hoist</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">runIdentity</span><span class="hs-special">)</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><a href="#local-6989586621679251805"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StateT</span><span> </span><a href="#local-6989586621679251806"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679251805"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><a href="#local-6989586621679251804"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MaybeT</span><span> </span><a href="#local-6989586621679251804"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><a href="#local-6989586621679251802"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679251803"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679251802"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><a href="#local-6989586621679251800"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ReaderT</span><span> </span><a href="#local-6989586621679251801"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679251800"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><a href="#local-6989586621679251799"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GenT</span><span> </span><a href="#local-6989586621679251799"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><a href="#local-6989586621679251798"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PropertyT</span><span> </span><a href="#local-6989586621679251798"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">-- | Run a quote from an empty identifier state. Note that the resulting term cannot necessarily</span><span>
</span><a name="line-74"></a><span class="hs-comment">-- be safely combined with other terms - that should happen inside 'QuoteT'.</span><span>
</span><a name="line-75"></a><span class="hs-identifier">runQuoteT</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679251835"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#QuoteT"><span class="hs-identifier hs-type">QuoteT</span></a><span> </span><a href="#local-6989586621679251835"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679251836"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679251835"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679251836"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-76"></a><a name="runQuoteT"><a href="Language.PlutusCore.Quote.html#runQuoteT"><span class="hs-identifier">runQuoteT</span></a></a><span> </span><a name="local-6989586621679251837"><a href="#local-6989586621679251837"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">evalStateT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unQuoteT</span><span> </span><a href="#local-6989586621679251837"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span> </span><a href="Language.PlutusCore.Quote.html#emptyFreshState"><span class="hs-identifier hs-var">emptyFreshState</span></a><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-comment">-- | A non-transformer version of 'QuoteT'.</span><span>
</span><a name="line-79"></a><span class="hs-keyword">type</span><span> </span><a name="Quote"><a href="Language.PlutusCore.Quote.html#Quote"><span class="hs-identifier">Quote</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Quote.html#QuoteT"><span class="hs-identifier hs-type">QuoteT</span></a><span> </span><span class="hs-identifier hs-type">Identity</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- | See 'runQuoteT'.</span><span>
</span><a name="line-82"></a><span class="hs-identifier">runQuote</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Quote.html#Quote"><span class="hs-identifier hs-type">Quote</span></a><span> </span><a href="#local-6989586621679251834"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679251834"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-83"></a><a name="runQuote"><a href="Language.PlutusCore.Quote.html#runQuote"><span class="hs-identifier">runQuote</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">runIdentity</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.PlutusCore.Quote.html#runQuoteT"><span class="hs-identifier hs-var">runQuoteT</span></a><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-comment">-- | Marks all the 'Unique's in a type as used, so they will not be generated in future. Useful if you</span><span>
</span><a name="line-86"></a><span class="hs-comment">-- have a type which was not generated in 'Quote'.</span><span>
</span><a name="line-87"></a><span class="hs-identifier">markNonFreshType</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Name.html#HasUnique"><span class="hs-identifier hs-type">HasUnique</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679251831"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679251832"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="Language.PlutusCore.Name.html#TypeUnique"><span class="hs-identifier hs-type">TypeUnique</span></a><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><a href="#local-6989586621679251833"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="#local-6989586621679251831"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679251832"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-90"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679251833"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-91"></a><a name="markNonFreshType"><a href="Language.PlutusCore.Quote.html#markNonFreshType"><span class="hs-identifier">markNonFreshType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Quote.html#markNonFresh"><span class="hs-identifier hs-var">markNonFresh</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">maximum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.PlutusCore.Quote.html#collectTypeUniques"><span class="hs-identifier hs-var">collectTypeUniques</span></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-comment">-- | Marks all the 'Unique's in a term as used, so they will not be generated in future. Useful if you</span><span>
</span><a name="line-94"></a><span class="hs-comment">-- have a term which was not generated in 'Quote'.</span><span>
</span><a name="line-95"></a><span class="hs-identifier">markNonFreshTerm</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Name.html#HasUnique"><span class="hs-identifier hs-type">HasUnique</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679251827"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679251828"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="Language.PlutusCore.Name.html#TypeUnique"><span class="hs-identifier hs-type">TypeUnique</span></a><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Name.html#HasUnique"><span class="hs-identifier hs-type">HasUnique</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679251829"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679251828"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="Language.PlutusCore.Name.html#TermUnique"><span class="hs-identifier hs-type">TermUnique</span></a><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><a href="#local-6989586621679251830"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="#local-6989586621679251827"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679251829"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679251828"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-98"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679251830"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><a name="markNonFreshTerm"><a href="Language.PlutusCore.Quote.html#markNonFreshTerm"><span class="hs-identifier">markNonFreshTerm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Quote.html#markNonFresh"><span class="hs-identifier hs-var">markNonFresh</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">maximum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.PlutusCore.Quote.html#collectTermUniques"><span class="hs-identifier hs-var">collectTermUniques</span></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-comment">-- | Marks all the 'Unique's in a program as used, so they will not be generated in future. Useful if you</span><span>
</span><a name="line-102"></a><span class="hs-comment">-- have a program which was not generated in 'Quote'.</span><span>
</span><a name="line-103"></a><span class="hs-identifier">markNonFreshProgram</span><span>
</span><a name="line-104"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Name.html#HasUnique"><span class="hs-identifier hs-type">HasUnique</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679251823"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679251824"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="Language.PlutusCore.Name.html#TypeUnique"><span class="hs-identifier hs-type">TypeUnique</span></a><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Name.html#HasUnique"><span class="hs-identifier hs-type">HasUnique</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679251825"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679251824"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="Language.PlutusCore.Name.html#TermUnique"><span class="hs-identifier hs-type">TermUnique</span></a><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><a href="#local-6989586621679251826"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a><span> </span><a href="#local-6989586621679251823"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679251825"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679251824"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-106"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679251826"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-107"></a><a name="markNonFreshProgram"><a href="Language.PlutusCore.Quote.html#markNonFreshProgram"><span class="hs-identifier">markNonFreshProgram</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Program"><span class="hs-identifier hs-var">Program</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251838"><a href="#local-6989586621679251838"><span class="hs-identifier">body</span></a></a><span class="hs-special">)</span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Quote.html#markNonFreshTerm"><span class="hs-identifier hs-var">markNonFreshTerm</span></a><span> </span><a href="#local-6989586621679251838"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-comment">-- | Mark a given 'Unique' (and implicitly all 'Unique's less than it) as used, so they will not be generated in future.</span><span>
</span><a name="line-110"></a><span class="hs-identifier">markNonFresh</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><a href="#local-6989586621679251822"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Name.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679251822"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-111"></a><a name="markNonFresh"><a href="Language.PlutusCore.Quote.html#markNonFresh"><span class="hs-identifier">markNonFresh</span></a></a><span> </span><a name="local-6989586621679251839"><a href="#local-6989586621679251839"><span class="hs-identifier">nonFresh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Quote.html#liftQuote"><span class="hs-identifier hs-var">liftQuote</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-112"></a><span>    </span><a name="local-6989586621679251840"><a href="#local-6989586621679251840"><span class="hs-identifier">nextU</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">get</span><span>
</span><a name="line-113"></a><span>    </span><span class="hs-identifier hs-var">put</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Name.html#Unique"><span class="hs-identifier hs-var">Unique</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">max</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unUnique</span><span> </span><a href="#local-6989586621679251839"><span class="hs-identifier hs-var">nonFresh</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unUnique</span><span> </span><a href="#local-6989586621679251840"><span class="hs-identifier hs-var">nextU</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-identifier">collectTypeUniques</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Name.html#HasUnique"><span class="hs-identifier hs-type">HasUnique</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679251820"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679251821"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="Language.PlutusCore.Name.html#TypeUnique"><span class="hs-identifier hs-type">TypeUnique</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="#local-6989586621679251820"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679251821"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set.Set</span><span> </span><a href="Language.PlutusCore.Name.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span>
</span><a name="line-116"></a><a name="collectTypeUniques"><a href="Language.PlutusCore.Quote.html#collectTypeUniques"><span class="hs-identifier">collectTypeUniques</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cata</span><span> </span><a href="#local-6989586621679251841"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-117"></a><span>    </span><a name="local-6989586621679251841"><a href="#local-6989586621679251841"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-118"></a><span>        </span><a href="Language.PlutusCore.Type.html#TyVarF"><span class="hs-identifier hs-var">TyVarF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251842"><a href="#local-6989586621679251842"><span class="hs-identifier">tn</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.singleton</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679251842"><span class="hs-identifier hs-var">tn</span></a><span> </span><span class="hs-operator hs-var">^.</span><span> </span><a href="Language.PlutusCore.Name.html#unique"><span class="hs-identifier hs-var">unique</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">coerced</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>        </span><a href="Language.PlutusCore.Type.html#TyForallF"><span class="hs-identifier hs-var">TyForallF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251843"><a href="#local-6989586621679251843"><span class="hs-identifier">tn</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251844"><a href="#local-6989586621679251844"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.insert</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679251843"><span class="hs-identifier hs-var">tn</span></a><span> </span><span class="hs-operator hs-var">^.</span><span> </span><a href="Language.PlutusCore.Name.html#unique"><span class="hs-identifier hs-var">unique</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">coerced</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679251844"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-120"></a><span>        </span><a href="Language.PlutusCore.Type.html#TyLamF"><span class="hs-identifier hs-var">TyLamF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251845"><a href="#local-6989586621679251845"><span class="hs-identifier">tn</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251846"><a href="#local-6989586621679251846"><span class="hs-identifier">t</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.insert</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679251845"><span class="hs-identifier hs-var">tn</span></a><span> </span><span class="hs-operator hs-var">^.</span><span> </span><a href="Language.PlutusCore.Name.html#unique"><span class="hs-identifier hs-var">unique</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">coerced</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679251846"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-121"></a><span>        </span><a href="Language.PlutusCore.Type.html#TyAppF"><span class="hs-identifier hs-var">TyAppF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251847"><a href="#local-6989586621679251847"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679251848"><a href="#local-6989586621679251848"><span class="hs-identifier">t2</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679251847"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679251848"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-122"></a><span>        </span><a href="Language.PlutusCore.Type.html#TyFunF"><span class="hs-identifier hs-var">TyFunF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251849"><a href="#local-6989586621679251849"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679251850"><a href="#local-6989586621679251850"><span class="hs-identifier">t2</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679251849"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679251850"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-123"></a><span>        </span><a href="Language.PlutusCore.Type.html#TyIFixF"><span class="hs-identifier hs-var">TyIFixF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251851"><a href="#local-6989586621679251851"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679251852"><a href="#local-6989586621679251852"><span class="hs-identifier">arg</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679251851"><span class="hs-identifier hs-var">pat</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679251852"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-124"></a><span>        </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-identifier">collectTermUniques</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Name.html#HasUnique"><span class="hs-identifier hs-type">HasUnique</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679251817"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679251818"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="Language.PlutusCore.Name.html#TypeUnique"><span class="hs-identifier hs-type">TypeUnique</span></a><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Name.html#HasUnique"><span class="hs-identifier hs-type">HasUnique</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679251819"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679251818"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="Language.PlutusCore.Name.html#TermUnique"><span class="hs-identifier hs-type">TermUnique</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="#local-6989586621679251817"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679251819"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679251818"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set.Set</span><span> </span><a href="Language.PlutusCore.Name.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span>
</span><a name="line-127"></a><a name="collectTermUniques"><a href="Language.PlutusCore.Quote.html#collectTermUniques"><span class="hs-identifier">collectTermUniques</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cata</span><span> </span><a href="#local-6989586621679251853"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-128"></a><span>    </span><a name="local-6989586621679251853"><a href="#local-6989586621679251853"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-129"></a><span>        </span><a href="Language.PlutusCore.Type.html#VarF"><span class="hs-identifier hs-var">VarF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251854"><a href="#local-6989586621679251854"><span class="hs-identifier">n</span></a></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.singleton</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679251854"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">^.</span><span> </span><a href="Language.PlutusCore.Name.html#unique"><span class="hs-identifier hs-var">unique</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">coerced</span><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>        </span><a href="Language.PlutusCore.Type.html#LamAbsF"><span class="hs-identifier hs-var">LamAbsF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251855"><a href="#local-6989586621679251855"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679251856"><a href="#local-6989586621679251856"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679251857"><a href="#local-6989586621679251857"><span class="hs-identifier">t</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.insert</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679251855"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">^.</span><span> </span><a href="Language.PlutusCore.Name.html#unique"><span class="hs-identifier hs-var">unique</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">coerced</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Quote.html#collectTypeUniques"><span class="hs-identifier hs-var">collectTypeUniques</span></a><span> </span><a href="#local-6989586621679251856"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679251857"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>        </span><a href="Language.PlutusCore.Type.html#TyAbsF"><span class="hs-identifier hs-var">TyAbsF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251858"><a href="#local-6989586621679251858"><span class="hs-identifier">tn</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251859"><a href="#local-6989586621679251859"><span class="hs-identifier">t</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Set.insert</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679251858"><span class="hs-identifier hs-var">tn</span></a><span> </span><span class="hs-operator hs-var">^.</span><span> </span><a href="Language.PlutusCore.Name.html#unique"><span class="hs-identifier hs-var">unique</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">coerced</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679251859"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-132"></a><span>        </span><a href="Language.PlutusCore.Type.html#TyInstF"><span class="hs-identifier hs-var">TyInstF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251860"><a href="#local-6989586621679251860"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679251861"><a href="#local-6989586621679251861"><span class="hs-identifier">ty</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679251860"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#collectTypeUniques"><span class="hs-identifier hs-var">collectTypeUniques</span></a><span> </span><a href="#local-6989586621679251861"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-133"></a><span>        </span><a href="Language.PlutusCore.Type.html#ApplyF"><span class="hs-identifier hs-var">ApplyF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251862"><a href="#local-6989586621679251862"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679251863"><a href="#local-6989586621679251863"><span class="hs-identifier">t2</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679251862"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679251863"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-134"></a><span>        </span><a href="Language.PlutusCore.Type.html#IWrapF"><span class="hs-identifier hs-var">IWrapF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251864"><a href="#local-6989586621679251864"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679251865"><a href="#local-6989586621679251865"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679251866"><a href="#local-6989586621679251866"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#collectTypeUniques"><span class="hs-identifier hs-var">collectTypeUniques</span></a><span> </span><a href="#local-6989586621679251864"><span class="hs-identifier hs-var">pat</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#collectTypeUniques"><span class="hs-identifier hs-var">collectTypeUniques</span></a><span> </span><a href="#local-6989586621679251865"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679251866"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-135"></a><span>        </span><a href="Language.PlutusCore.Type.html#UnwrapF"><span class="hs-identifier hs-var">UnwrapF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251867"><a href="#local-6989586621679251867"><span class="hs-identifier">t</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679251867"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-136"></a><span>        </span><a href="Language.PlutusCore.Type.html#ErrorF"><span class="hs-identifier hs-var">ErrorF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679251868"><a href="#local-6989586621679251868"><span class="hs-identifier">ty</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#collectTypeUniques"><span class="hs-identifier hs-var">collectTypeUniques</span></a><span> </span><a href="#local-6989586621679251868"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-137"></a><span>        </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">-- | Get a fresh 'Unique'.</span><span>
</span><a name="line-140"></a><span class="hs-identifier">freshUnique</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">MonadQuote</span></a><span> </span><a href="#local-6989586621679251816"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679251816"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Language.PlutusCore.Name.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span>
</span><a name="line-141"></a><a name="freshUnique"><a href="Language.PlutusCore.Quote.html#freshUnique"><span class="hs-identifier">freshUnique</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Quote.html#liftQuote"><span class="hs-identifier hs-var">liftQuote</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-142"></a><span>    </span><a name="local-6989586621679251869"><a href="#local-6989586621679251869"><span class="hs-identifier">nextU</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">get</span><span>
</span><a name="line-143"></a><span>    </span><span class="hs-identifier hs-var">put</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Name.html#Unique"><span class="hs-identifier hs-var">Unique</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">unUnique</span><span> </span><a href="#local-6989586621679251869"><span class="hs-identifier hs-var">nextU</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>    </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679251869"><span class="hs-identifier hs-var">nextU</span></a><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-comment">-- | Get a fresh 'Name', given the annotation and the 'Text.Text' name.</span><span>
</span><a name="line-147"></a><span class="hs-identifier">freshName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679251814"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679251815"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#QuoteT"><span class="hs-identifier hs-type">QuoteT</span></a><span> </span><a href="#local-6989586621679251814"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679251815"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-148"></a><a name="freshName"><a href="Language.PlutusCore.Quote.html#freshName"><span class="hs-identifier">freshName</span></a></a><span> </span><a name="local-6989586621679251870"><a href="#local-6989586621679251870"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621679251871"><a href="#local-6989586621679251871"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><a href="#local-6989586621679251870"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621679251871"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#freshUnique"><span class="hs-identifier hs-var">freshUnique</span></a><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-comment">-- | Make a copy of the given 'Name' that is distinct from the old one.</span><span>
</span><a name="line-151"></a><span class="hs-identifier">freshenName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679251812"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679251813"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#QuoteT"><span class="hs-identifier hs-type">QuoteT</span></a><span> </span><a href="#local-6989586621679251812"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679251813"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-152"></a><a name="freshenName"><a href="Language.PlutusCore.Quote.html#freshenName"><span class="hs-identifier">freshenName</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><a name="local-6989586621679251872"><a href="#local-6989586621679251872"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621679251873"><a href="#local-6989586621679251873"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><a href="#local-6989586621679251872"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621679251873"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#freshUnique"><span class="hs-identifier hs-var">freshUnique</span></a><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span class="hs-comment">-- | Get a fresh 'TyName', given the annotation and the 'Text.Text' name.</span><span>
</span><a name="line-155"></a><span class="hs-identifier">freshTyName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679251810"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679251811"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#QuoteT"><span class="hs-identifier hs-type">QuoteT</span></a><span> </span><a href="#local-6989586621679251810"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="#local-6989586621679251811"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-156"></a><a name="freshTyName"><a href="Language.PlutusCore.Quote.html#freshTyName"><span class="hs-identifier">freshTyName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-var">TyName</span></a><span> </span><span class="hs-operator hs-var">.*</span><span> </span><a href="Language.PlutusCore.Quote.html#freshName"><span class="hs-identifier hs-var">freshName</span></a><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-comment">-- | Make a copy of the given 'TyName' that is distinct from the old one.</span><span>
</span><a name="line-159"></a><span class="hs-identifier">freshenTyName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679251808"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="#local-6989586621679251809"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#QuoteT"><span class="hs-identifier hs-type">QuoteT</span></a><span> </span><a href="#local-6989586621679251808"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="#local-6989586621679251809"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-160"></a><a name="freshenTyName"><a href="Language.PlutusCore.Quote.html#freshenTyName"><span class="hs-identifier">freshenTyName</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-var">TyName</span></a><span> </span><a name="local-6989586621679251874"><a href="#local-6989586621679251874"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-var">TyName</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Quote.html#freshenName"><span class="hs-identifier hs-var">freshenName</span></a><span> </span><a href="#local-6989586621679251874"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-161"></a></pre></body></html>