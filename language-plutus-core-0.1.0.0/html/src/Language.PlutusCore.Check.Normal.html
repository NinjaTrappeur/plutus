<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DuplicateRecordFields #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings     #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE RankNTypes            #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-comment">-- | This module makes sure terms and types are well-formed according to Fig. 2</span><span>
</span><a name="line-6"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.PlutusCore.Check.Normal</span><span> </span><span class="hs-special">(</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#check"><span class="hs-identifier hs-var">check</span></a><span>
</span><a name="line-7"></a><span>                                        </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#checkProgram"><span class="hs-identifier hs-var">checkProgram</span></a><span>
</span><a name="line-8"></a><span>                                        </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#checkTerm"><span class="hs-identifier hs-var">checkTerm</span></a><span>
</span><a name="line-9"></a><span>                                        </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Error.html#NormalizationError"><span class="hs-identifier hs-type">NormalizationError</span></a><span>
</span><a name="line-10"></a><span>                                        </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#isTypeValue"><span class="hs-identifier hs-var">isTypeValue</span></a><span>
</span><a name="line-11"></a><span>                                        </span><span class="hs-special">,</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#isTermValue"><span class="hs-identifier hs-var">isTermValue</span></a><span>
</span><a name="line-12"></a><span>                                        </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Monad.Except</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Functor.Foldable</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span>           </span><a href="Data.Functor.Foldable.Monadic.html"><span class="hs-identifier">Data.Functor.Foldable.Monadic</span></a><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.PlutusCore.Error.html"><span class="hs-identifier">Language.PlutusCore.Error</span></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.PlutusCore.Name.html"><span class="hs-identifier">Language.PlutusCore.Name</span></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span>           </span><a href="Language.PlutusCore.Type.html"><span class="hs-identifier">Language.PlutusCore.Type</span></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span>           </span><a href="PlutusPrelude.html"><span class="hs-identifier">PlutusPrelude</span></a><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-comment">-- | Ensure that all terms and types are well-formed accoring to Fig. 2</span><span>
</span><a name="line-25"></a><span class="hs-identifier">checkProgram</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Error.html#AsNormalizationError"><span class="hs-identifier hs-type">AsNormalizationError</span></a><span> </span><a href="#local-6989586621679642158"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679642159"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadError</span><span> </span><a href="#local-6989586621679642158"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679642160"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679642159"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679642160"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><a name="checkProgram"><a href="Language.PlutusCore.Check.Normal.html#checkProgram"><span class="hs-identifier">checkProgram</span></a></a><span> </span><a name="local-6989586621679642161"><a href="#local-6989586621679642161"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">void</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Error.html#throwingEither"><span class="hs-identifier hs-var">throwingEither</span></a><span> </span><a href="Language.PlutusCore.Error.html#_NormalizationError"><span class="hs-identifier hs-var">_NormalizationError</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#preCheck"><span class="hs-identifier hs-var">preCheck</span></a><span> </span><a href="#local-6989586621679642161"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-comment">-- | Ensure that all terms and types are well-formed accoring to Fig. 2</span><span>
</span><a name="line-29"></a><span class="hs-identifier">checkTerm</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Error.html#AsNormalizationError"><span class="hs-identifier hs-type">AsNormalizationError</span></a><span> </span><a href="#local-6989586621679642155"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679642156"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadError</span><span> </span><a href="#local-6989586621679642155"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679642157"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="Language.PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a><span> </span><a href="Language.PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="#local-6989586621679642156"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679642157"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><a name="checkTerm"><a href="Language.PlutusCore.Check.Normal.html#checkTerm"><span class="hs-identifier">checkTerm</span></a></a><span> </span><a name="local-6989586621679642162"><a href="#local-6989586621679642162"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">void</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Error.html#throwingEither"><span class="hs-identifier hs-var">throwingEither</span></a><span> </span><a href="Language.PlutusCore.Error.html#_NormalizationError"><span class="hs-identifier hs-var">_NormalizationError</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#checkTerm"><span class="hs-identifier hs-var">checkTerm</span></a><span> </span><a href="#local-6989586621679642162"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-identifier">check</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a><span> </span><a href="#local-6989586621679642152"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642153"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642154"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Error.html#NormalizationError"><span class="hs-identifier hs-type">NormalizationError</span></a><span> </span><a href="#local-6989586621679642152"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642153"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642154"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-33"></a><a name="check"><a href="Language.PlutusCore.Check.Normal.html#check"><span class="hs-identifier">check</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679642163"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#preCheck"><span class="hs-identifier hs-var">preCheck</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-34"></a><span>    </span><a name="local-6989586621679642163"><a href="#local-6989586621679642163"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-identifier hs-var">Right</span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-35"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679642164"><a href="#local-6989586621679642164"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679642164"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">-- | Ensure that all terms and types are well-formed accoring to Fig. 2</span><span>
</span><a name="line-38"></a><span class="hs-identifier">preCheck</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a><span> </span><a href="#local-6989586621679642149"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642150"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642151"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Error.html#NormalizationError"><span class="hs-identifier hs-type">NormalizationError</span></a><span> </span><a href="#local-6989586621679642149"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642150"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642151"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a><span> </span><a href="#local-6989586621679642149"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642150"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642151"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><a name="preCheck"><a href="Language.PlutusCore.Check.Normal.html#preCheck"><span class="hs-identifier">preCheck</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Program"><span class="hs-identifier hs-var">Program</span></a><span> </span><a name="local-6989586621679642165"><a href="#local-6989586621679642165"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679642166"><a href="#local-6989586621679642166"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679642167"><a href="#local-6989586621679642167"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#Program"><span class="hs-identifier hs-var">Program</span></a><span> </span><a href="#local-6989586621679642165"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679642166"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#checkT"><span class="hs-identifier hs-var">checkT</span></a><span> </span><a href="#local-6989586621679642167"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-comment">-- this basically ensures all type instatiations, etc. occur only with type *values*</span><span>
</span><a name="line-42"></a><span class="hs-identifier">checkT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="#local-6989586621679642146"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642147"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642148"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Error.html#NormalizationError"><span class="hs-identifier hs-type">NormalizationError</span></a><span> </span><a href="#local-6989586621679642146"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642147"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642148"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="#local-6989586621679642146"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642147"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642148"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-43"></a><a name="checkT"><a href="Language.PlutusCore.Check.Normal.html#checkT"><span class="hs-identifier">checkT</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Error"><span class="hs-identifier hs-var">Error</span></a><span> </span><a name="local-6989586621679642168"><a href="#local-6989586621679642168"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679642169"><a href="#local-6989586621679642169"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#Error"><span class="hs-identifier hs-var">Error</span></a><span> </span><a href="#local-6989586621679642168"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#typeValue"><span class="hs-identifier hs-var">typeValue</span></a><span> </span><a href="#local-6989586621679642169"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-44"></a><span class="hs-identifier">checkT</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#TyInst"><span class="hs-identifier hs-var">TyInst</span></a><span> </span><a name="local-6989586621679642170"><a href="#local-6989586621679642170"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679642171"><a href="#local-6989586621679642171"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679642172"><a href="#local-6989586621679642172"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#TyInst"><span class="hs-identifier hs-var">TyInst</span></a><span> </span><a href="#local-6989586621679642170"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#checkT"><span class="hs-identifier hs-var">checkT</span></a><span> </span><a href="#local-6989586621679642171"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#typeValue"><span class="hs-identifier hs-var">typeValue</span></a><span> </span><a href="#local-6989586621679642172"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-45"></a><span class="hs-identifier">checkT</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#IWrap"><span class="hs-identifier hs-var">IWrap</span></a><span> </span><a name="local-6989586621679642173"><a href="#local-6989586621679642173"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679642174"><a href="#local-6989586621679642174"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679642175"><a href="#local-6989586621679642175"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679642176"><a href="#local-6989586621679642176"><span class="hs-identifier">term</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#IWrap"><span class="hs-identifier hs-var">IWrap</span></a><span> </span><a href="#local-6989586621679642173"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#typeValue"><span class="hs-identifier hs-var">typeValue</span></a><span> </span><a href="#local-6989586621679642174"><span class="hs-identifier hs-var">pat</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#typeValue"><span class="hs-identifier hs-var">typeValue</span></a><span> </span><a href="#local-6989586621679642175"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#checkT"><span class="hs-identifier hs-var">checkT</span></a><span> </span><a href="#local-6989586621679642176"><span class="hs-identifier hs-var">term</span></a><span>
</span><a name="line-46"></a><span class="hs-identifier">checkT</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Unwrap"><span class="hs-identifier hs-var">Unwrap</span></a><span> </span><a name="local-6989586621679642177"><a href="#local-6989586621679642177"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679642178"><a href="#local-6989586621679642178"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#Unwrap"><span class="hs-identifier hs-var">Unwrap</span></a><span> </span><a href="#local-6989586621679642177"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#checkT"><span class="hs-identifier hs-var">checkT</span></a><span> </span><a href="#local-6989586621679642178"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-47"></a><span class="hs-identifier">checkT</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#LamAbs"><span class="hs-identifier hs-var">LamAbs</span></a><span> </span><a name="local-6989586621679642179"><a href="#local-6989586621679642179"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679642180"><a href="#local-6989586621679642180"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679642181"><a href="#local-6989586621679642181"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679642182"><a href="#local-6989586621679642182"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#LamAbs"><span class="hs-identifier hs-var">LamAbs</span></a><span> </span><a href="#local-6989586621679642179"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679642180"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#typeValue"><span class="hs-identifier hs-var">typeValue</span></a><span> </span><a href="#local-6989586621679642181"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#checkT"><span class="hs-identifier hs-var">checkT</span></a><span> </span><a href="#local-6989586621679642182"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-48"></a><span class="hs-identifier">checkT</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Apply"><span class="hs-identifier hs-var">Apply</span></a><span> </span><a name="local-6989586621679642183"><a href="#local-6989586621679642183"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679642184"><a href="#local-6989586621679642184"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679642185"><a href="#local-6989586621679642185"><span class="hs-identifier">t'</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#Apply"><span class="hs-identifier hs-var">Apply</span></a><span> </span><a href="#local-6989586621679642183"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#checkT"><span class="hs-identifier hs-var">checkT</span></a><span> </span><a href="#local-6989586621679642184"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#checkT"><span class="hs-identifier hs-var">checkT</span></a><span> </span><a href="#local-6989586621679642185"><span class="hs-identifier hs-var">t'</span></a><span>
</span><a name="line-49"></a><span class="hs-identifier">checkT</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#TyAbs"><span class="hs-identifier hs-var">TyAbs</span></a><span> </span><a name="local-6989586621679642186"><a href="#local-6989586621679642186"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679642187"><a href="#local-6989586621679642187"><span class="hs-identifier">tn</span></a></a><span> </span><a name="local-6989586621679642188"><a href="#local-6989586621679642188"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679642189"><a href="#local-6989586621679642189"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#TyAbs"><span class="hs-identifier hs-var">TyAbs</span></a><span> </span><a href="#local-6989586621679642186"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679642187"><span class="hs-identifier hs-var">tn</span></a><span> </span><a href="#local-6989586621679642188"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#termValue"><span class="hs-identifier hs-var">termValue</span></a><span> </span><a href="#local-6989586621679642189"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-50"></a><span class="hs-identifier">checkT</span><span> </span><a name="local-6989586621679642190"><a href="#local-6989586621679642190"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><a href="Language.PlutusCore.Type.html#Var"><span class="hs-identifier hs-var">Var</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679642190"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-51"></a><span class="hs-identifier">checkT</span><span> </span><a name="local-6989586621679642191"><a href="#local-6989586621679642191"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><a href="Language.PlutusCore.Type.html#Constant"><span class="hs-identifier hs-var">Constant</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679642191"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-52"></a><span class="hs-identifier">checkT</span><span> </span><a name="local-6989586621679642192"><a href="#local-6989586621679642192"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><a href="Language.PlutusCore.Type.html#Builtin"><span class="hs-identifier hs-var">Builtin</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679642192"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-identifier">isTermValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="#local-6989586621679642143"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642144"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642145"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-55"></a><a name="isTermValue"><a href="Language.PlutusCore.Check.Normal.html#isTermValue"><span class="hs-identifier">isTermValue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isRight</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#termValue"><span class="hs-identifier hs-var">termValue</span></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- ensure a term is a value</span><span>
</span><a name="line-58"></a><span class="hs-identifier">termValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="#local-6989586621679642140"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642141"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642142"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Error.html#NormalizationError"><span class="hs-identifier hs-type">NormalizationError</span></a><span> </span><a href="#local-6989586621679642140"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642141"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642142"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="#local-6989586621679642140"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642141"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642142"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-59"></a><a name="termValue"><a href="Language.PlutusCore.Check.Normal.html#termValue"><span class="hs-identifier">termValue</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#LamAbs"><span class="hs-identifier hs-var">LamAbs</span></a><span> </span><a name="local-6989586621679642193"><a href="#local-6989586621679642193"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679642194"><a href="#local-6989586621679642194"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679642195"><a href="#local-6989586621679642195"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679642196"><a href="#local-6989586621679642196"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#LamAbs"><span class="hs-identifier hs-var">LamAbs</span></a><span> </span><a href="#local-6989586621679642193"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679642194"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679642195"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#checkT"><span class="hs-identifier hs-var">checkT</span></a><span> </span><a href="#local-6989586621679642196"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-60"></a><span class="hs-identifier">termValue</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#IWrap"><span class="hs-identifier hs-var">IWrap</span></a><span> </span><a name="local-6989586621679642197"><a href="#local-6989586621679642197"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679642198"><a href="#local-6989586621679642198"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679642199"><a href="#local-6989586621679642199"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679642200"><a href="#local-6989586621679642200"><span class="hs-identifier">term</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#IWrap"><span class="hs-identifier hs-var">IWrap</span></a><span> </span><a href="#local-6989586621679642197"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679642198"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679642199"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#termValue"><span class="hs-identifier hs-var">termValue</span></a><span> </span><a href="#local-6989586621679642200"><span class="hs-identifier hs-var">term</span></a><span>
</span><a name="line-61"></a><span class="hs-identifier">termValue</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#TyAbs"><span class="hs-identifier hs-var">TyAbs</span></a><span> </span><a name="local-6989586621679642201"><a href="#local-6989586621679642201"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679642202"><a href="#local-6989586621679642202"><span class="hs-identifier">tn</span></a></a><span> </span><a name="local-6989586621679642203"><a href="#local-6989586621679642203"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679642204"><a href="#local-6989586621679642204"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#TyAbs"><span class="hs-identifier hs-var">TyAbs</span></a><span> </span><a href="#local-6989586621679642201"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679642202"><span class="hs-identifier hs-var">tn</span></a><span> </span><a href="#local-6989586621679642203"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#termValue"><span class="hs-identifier hs-var">termValue</span></a><span> </span><a href="#local-6989586621679642204"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-62"></a><span class="hs-identifier">termValue</span><span> </span><a name="local-6989586621679642205"><a href="#local-6989586621679642205"><span class="hs-identifier">t</span></a></a><span>                      </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#builtinValue"><span class="hs-identifier hs-var">builtinValue</span></a><span> </span><a href="#local-6989586621679642205"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">{- Note [Builtin applications and values]
An older version of the specification had a special case for builtin applications being
term values. This is important, because they obviously can't be reduced before runtime.
However, it was missing a corresponding case for builtin *type* applications, which
resulted in types like `[(con integer) (con 64)]` not being considered normalized, which
effectively prevents you using integers anywhere.

The current version of the specification has moved to fully saturated builtins and builtin types,
but the implementation is not there. Consequently we include the special cases for builtin applications
and also consider builtin types and type level integers to be neutral types.
-}</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">-- See note [Builtin applications and values]</span><span>
</span><a name="line-77"></a><span class="hs-identifier">builtinValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="#local-6989586621679642137"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642138"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642139"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Error.html#NormalizationError"><span class="hs-identifier hs-type">NormalizationError</span></a><span> </span><a href="#local-6989586621679642137"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642138"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642139"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a><span> </span><a href="#local-6989586621679642137"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642138"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642139"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-78"></a><a name="builtinValue"><a href="Language.PlutusCore.Check.Normal.html#builtinValue"><span class="hs-identifier">builtinValue</span></a></a><span> </span><a name="local-6989586621679642206"><a href="#local-6989586621679642206"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><a href="Language.PlutusCore.Type.html#Constant"><span class="hs-identifier hs-var">Constant</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679642206"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-79"></a><span class="hs-identifier">builtinValue</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#TyInst"><span class="hs-identifier hs-var">TyInst</span></a><span> </span><a name="local-6989586621679642207"><a href="#local-6989586621679642207"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679642208"><a href="#local-6989586621679642208"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679642209"><a href="#local-6989586621679642209"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#TyInst"><span class="hs-identifier hs-var">TyInst</span></a><span> </span><a href="#local-6989586621679642207"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#builtinValue"><span class="hs-identifier hs-var">builtinValue</span></a><span> </span><a href="#local-6989586621679642208"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679642209"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-80"></a><span class="hs-identifier">builtinValue</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Apply"><span class="hs-identifier hs-var">Apply</span></a><span> </span><a name="local-6989586621679642210"><a href="#local-6989586621679642210"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679642211"><a href="#local-6989586621679642211"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679642212"><a href="#local-6989586621679642212"><span class="hs-identifier">t'</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#Apply"><span class="hs-identifier hs-var">Apply</span></a><span> </span><a href="#local-6989586621679642210"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#builtinValue"><span class="hs-identifier hs-var">builtinValue</span></a><span> </span><a href="#local-6989586621679642211"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#termValue"><span class="hs-identifier hs-var">termValue</span></a><span> </span><a href="#local-6989586621679642212"><span class="hs-identifier hs-var">t'</span></a><span>
</span><a name="line-81"></a><span class="hs-identifier">builtinValue</span><span> </span><a name="local-6989586621679642213"><a href="#local-6989586621679642213"><span class="hs-identifier">t</span></a></a><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.PlutusCore.Error.html#BadTerm"><span class="hs-identifier hs-var">BadTerm</span></a><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#termLoc"><span class="hs-identifier hs-var">termLoc</span></a><span> </span><a href="#local-6989586621679642213"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679642213"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-string">&quot;builtin value&quot;</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-identifier">isTypeValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="#local-6989586621679642135"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642136"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-84"></a><a name="isTypeValue"><a href="Language.PlutusCore.Check.Normal.html#isTypeValue"><span class="hs-identifier">isTypeValue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isRight</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#typeValue"><span class="hs-identifier hs-var">typeValue</span></a><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- ensure that a type is a type value</span><span>
</span><a name="line-87"></a><span class="hs-identifier">typeValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="#local-6989586621679642132"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642133"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Error.html#NormalizationError"><span class="hs-identifier hs-type">NormalizationError</span></a><span> </span><a href="#local-6989586621679642132"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642134"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642133"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="#local-6989586621679642132"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642133"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><a name="typeValue"><a href="Language.PlutusCore.Check.Normal.html#typeValue"><span class="hs-identifier">typeValue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Functor.Foldable.Monadic.html#cataM"><span class="hs-identifier hs-var">cataM</span></a><span> </span><a href="#local-6989586621679642214"><span class="hs-identifier hs-var">aM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span>    </span><a name="local-6989586621679642214"><a href="#local-6989586621679642214"><span class="hs-identifier">aM</span></a></a><span> </span><a name="local-6989586621679642216"><a href="#local-6989586621679642216"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679642215"><span class="hs-identifier hs-var">isTyValue</span></a><span> </span><a href="#local-6989586621679642216"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">embed</span><span> </span><a href="#local-6989586621679642216"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Check.Normal.html#neutralType"><span class="hs-identifier hs-var">neutralType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">embed</span><span> </span><a href="#local-6989586621679642216"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span>    </span><a name="local-6989586621679642215"><a href="#local-6989586621679642215"><span class="hs-identifier">isTyValue</span></a></a><span> </span><a href="Language.PlutusCore.Type.html#TyFunF"><span class="hs-identifier hs-var">TyFunF</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-identifier">isTyValue</span><span> </span><a href="Language.PlutusCore.Type.html#TyForallF"><span class="hs-identifier hs-var">TyForallF</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-identifier">isTyValue</span><span> </span><a href="Language.PlutusCore.Type.html#TyIFixF"><span class="hs-identifier hs-var">TyIFixF</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-identifier">isTyValue</span><span> </span><a href="Language.PlutusCore.Type.html#TyLamF"><span class="hs-identifier hs-var">TyLamF</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-identifier">isTyValue</span><span> </span><a href="Language.PlutusCore.Type.html#TyBuiltinF"><span class="hs-identifier hs-var">TyBuiltinF</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-98"></a><span>    </span><span class="hs-identifier">isTyValue</span><span> </span><a href="Language.PlutusCore.Type.html#TyIntF"><span class="hs-identifier hs-var">TyIntF</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-99"></a><span>    </span><span class="hs-identifier">isTyValue</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-comment">-- ensure a type is a neutral type</span><span>
</span><a name="line-102"></a><span class="hs-identifier">neutralType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.PlutusCore.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="#local-6989586621679642129"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642130"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Error.html#NormalizationError"><span class="hs-identifier hs-type">NormalizationError</span></a><span> </span><a href="#local-6989586621679642129"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642131"><span class="hs-identifier hs-type">name</span></a><span> </span><a href="#local-6989586621679642130"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="#local-6989586621679642129"><span class="hs-identifier hs-type">tyname</span></a><span> </span><a href="#local-6989586621679642130"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-103"></a><a name="neutralType"><a href="Language.PlutusCore.Check.Normal.html#neutralType"><span class="hs-identifier">neutralType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Functor.Foldable.Monadic.html#cataM"><span class="hs-identifier hs-var">cataM</span></a><span> </span><a href="#local-6989586621679642217"><span class="hs-identifier hs-var">aM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span>    </span><a name="local-6989586621679642217"><a href="#local-6989586621679642217"><span class="hs-identifier">aM</span></a></a><span> </span><a name="local-6989586621679642220"><a href="#local-6989586621679642220"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679642218"><span class="hs-identifier hs-var">isNeutralType</span></a><span> </span><a href="#local-6989586621679642220"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">embed</span><span> </span><a href="#local-6989586621679642220"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="Language.PlutusCore.Error.html#BadType"><span class="hs-identifier hs-var">BadType</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679642219"><span class="hs-identifier hs-var">tyLocF</span></a><span> </span><a href="#local-6989586621679642220"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">embed</span><span> </span><a href="#local-6989586621679642220"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;neutral type&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span>    </span><a name="local-6989586621679642218"><a href="#local-6989586621679642218"><span class="hs-identifier">isNeutralType</span></a></a><span> </span><a href="Language.PlutusCore.Type.html#TyVarF"><span class="hs-identifier hs-var">TyVarF</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-109"></a><span>    </span><span class="hs-identifier">isNeutralType</span><span> </span><a href="Language.PlutusCore.Type.html#TyAppF"><span class="hs-identifier hs-var">TyAppF</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-110"></a><span>    </span><span class="hs-comment">-- See note [Builtin applications and values]</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-identifier">isNeutralType</span><span> </span><a href="Language.PlutusCore.Type.html#TyBuiltinF"><span class="hs-identifier hs-var">TyBuiltinF</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-identifier">isNeutralType</span><span> </span><a href="Language.PlutusCore.Type.html#TyIntF"><span class="hs-identifier hs-var">TyIntF</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-113"></a><span>    </span><span class="hs-identifier">isNeutralType</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span>    </span><a name="local-6989586621679642219"><a href="#local-6989586621679642219"><span class="hs-identifier">tyLocF</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.PlutusCore.Type.html#tyLoc"><span class="hs-identifier hs-var">tyLoc</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">embed</span><span>
</span><a name="line-116"></a></pre></body></html>