<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts     #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE DerivingStrategies   #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE DeriveGeneric        #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE TemplateHaskell      #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass       #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE MonoLocalBinds       #-}</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- | A type for intervals and associated functions.</span><span>
</span><a name="line-9"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ledger.Interval</span><span class="hs-special">(</span><span>
</span><a name="line-10"></a><span>      </span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-type">Slot</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-type">Interval</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Ledger.Interval.html#SlotRange"><span class="hs-identifier hs-type">SlotRange</span></a><span>
</span><a name="line-13"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Ledger.Interval.html#interval"><span class="hs-identifier hs-var">interval</span></a><span>
</span><a name="line-14"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Ledger.Interval.html#from"><span class="hs-identifier hs-var">from</span></a><span>
</span><a name="line-15"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Ledger.Interval.html#to"><span class="hs-identifier hs-var">to</span></a><span>
</span><a name="line-16"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Ledger.Interval.html#singleton"><span class="hs-identifier hs-var">singleton</span></a><span>
</span><a name="line-17"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Ledger.Interval.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-18"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Ledger.Interval.html#always"><span class="hs-identifier hs-var">always</span></a><span>
</span><a name="line-19"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Ledger.Interval.html#member"><span class="hs-identifier hs-var">member</span></a><span>
</span><a name="line-20"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Ledger.Interval.html#width"><span class="hs-identifier hs-var">width</span></a><span>
</span><a name="line-21"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Ledger.Interval.html#contains"><span class="hs-identifier hs-var">contains</span></a><span>
</span><a name="line-22"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Ledger.Interval.html#before"><span class="hs-identifier hs-var">before</span></a><span>
</span><a name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Ledger.Interval.html#after"><span class="hs-identifier hs-var">after</span></a><span>
</span><a name="line-24"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Codec.Serialise.Class</span><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Serialise</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Aeson</span><span>                               </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Swagger.Internal.Schema</span><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToSchema</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC.Generics</span><span>                             </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Language.Haskell.TH</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Language.PlutusTx.Lift</span><span>                   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">makeLift</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-comment">-- | Slot number</span><span>
</span><a name="line-35"></a><span class="hs-keyword">newtype</span><span> </span><a name="Slot"><a href="Ledger.Interval.html#Slot"><span class="hs-identifier">Slot</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Slot"><a href="Ledger.Interval.html#Slot"><span class="hs-identifier">Slot</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="getSlot"><a href="Ledger.Interval.html#getSlot"><span class="hs-identifier">getSlot</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">anyclass</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToSchema</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">newtype</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Real</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Serialise</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-identifier hs-var">makeLift</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">Slot</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-comment">-- | An interval of @a@s. The interval is closed below and open above, meaning </span><span>
</span><a name="line-44"></a><span class="hs-comment">--   that @Interval (Just (10 :: Int)) (Just 11)@ contains a single value @11@.</span><span>
</span><a name="line-45"></a><span class="hs-comment">--   The interval is unbounded on either side: @Interval Nothing (Just 12)@ </span><span>
</span><a name="line-46"></a><span class="hs-comment">--   contains all numbers smaller than @12@.</span><span>
</span><a name="line-47"></a><span class="hs-comment">--   </span><span>
</span><a name="line-48"></a><span class="hs-keyword">data</span><span> </span><a name="Interval"><a href="Ledger.Interval.html#Interval"><span class="hs-identifier">Interval</span></a></a><span> </span><a name="local-6989586621679176521"><a href="#local-6989586621679176521"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Interval"><a href="Ledger.Interval.html#Interval"><span class="hs-identifier">Interval</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="ivFrom"><a href="Ledger.Interval.html#ivFrom"><span class="hs-identifier">ivFrom</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679176521"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a name="ivTo"><a href="Ledger.Interval.html#ivTo"><span class="hs-identifier">ivTo</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679176521"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-49"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">anyclass</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToSchema</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Serialise</span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-identifier hs-var">makeLift</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">Interval</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-keyword">type</span><span> </span><a name="SlotRange"><a href="Ledger.Interval.html#SlotRange"><span class="hs-identifier">SlotRange</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-type">Interval</span></a><span> </span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-type">Slot</span></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">{- note [Definition of Interval]

The purpose of this module is to provide an interval data type that 
can be used in on-chain and off-chain code alike. Its two main uses in the 
'wallet-api' module are the validity range of transactions, and the ranges of
funds and slot numbers for wallet triggers.

To ensure that 'Interval' can be used in on-chain code, the functions in this 
module do not use type classes or functions from the Haskell Prelude. The types 
of the query functions exported from here are specialised to
'Interval Slot'. 

-}</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- | A 'SlotRange' that covers every slot.</span><span>
</span><a name="line-73"></a><span class="hs-identifier">always</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TExp</span><span> </span><a href="Ledger.Interval.html#SlotRange"><span class="hs-identifier hs-type">SlotRange</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><a name="always"><a href="Ledger.Interval.html#always"><span class="hs-identifier">always</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[||</span><span> </span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-var">Interval</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">||]</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">-- | @from a@ is an 'Interval' that includes all values that are</span><span>
</span><a name="line-77"></a><span class="hs-comment">--  greater than or equal to @a@.</span><span>
</span><a name="line-78"></a><span class="hs-identifier">from</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TExp</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679192717"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-type">Interval</span></a><span> </span><a href="#local-6989586621679192717"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-79"></a><a name="from"><a href="Ledger.Interval.html#from"><span class="hs-identifier">from</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[||</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679192718"><a href="#local-6989586621679192718"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-var">Interval</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679192718"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">||]</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- | @to a@ is an 'Interval' that includes all values that are</span><span>
</span><a name="line-82"></a><span class="hs-comment">--  smaller than @a@.</span><span>
</span><a name="line-83"></a><span class="hs-identifier">to</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TExp</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679192716"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-type">Interval</span></a><span> </span><a href="#local-6989586621679192716"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-84"></a><a name="to"><a href="Ledger.Interval.html#to"><span class="hs-identifier">to</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[||</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679192719"><a href="#local-6989586621679192719"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-var">Interval</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679192719"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">||]</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- | @interval a b@ includes all values that are greater than or equal</span><span>
</span><a name="line-87"></a><span class="hs-comment">--   to @a@ and smaller than @b@. Therefore it includes @a@ but not it</span><span>
</span><a name="line-88"></a><span class="hs-comment">--   does not include @b@.</span><span>
</span><a name="line-89"></a><span class="hs-identifier">interval</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TExp</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679192715"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679192715"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-type">Interval</span></a><span> </span><a href="#local-6989586621679192715"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><a name="interval"><a href="Ledger.Interval.html#interval"><span class="hs-identifier">interval</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[||</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679192720"><a href="#local-6989586621679192720"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679192721"><a href="#local-6989586621679192721"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-var">Interval</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679192720"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679192721"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">||]</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-comment">-- | A 'SlotRange' that covers only a single slot.</span><span>
</span><a name="line-93"></a><span class="hs-identifier">singleton</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TExp</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-type">Slot</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ledger.Interval.html#SlotRange"><span class="hs-identifier hs-type">SlotRange</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-94"></a><a name="singleton"><a href="Ledger.Interval.html#singleton"><span class="hs-identifier">singleton</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[||</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a name="local-6989586621679192722"><a href="#local-6989586621679192722"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-var">Interval</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a href="#local-6989586621679192722"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679192722"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">||]</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-comment">-- | Check if a 'SlotRange' is empty</span><span>
</span><a name="line-97"></a><span class="hs-identifier">empty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TExp</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#SlotRange"><span class="hs-identifier hs-type">SlotRange</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><a name="empty"><a href="Ledger.Interval.html#empty"><span class="hs-identifier">empty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[||</span><span>
</span><a name="line-99"></a><span>    </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-var">Interval</span></a><span> </span><a name="local-6989586621679192723"><a href="#local-6989586621679192723"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679192724"><a href="#local-6989586621679192724"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-100"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679192723"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-101"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-102"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679192725"><a href="#local-6989586621679192725"><span class="hs-identifier">f'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679192724"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-103"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-104"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679192726"><a href="#local-6989586621679192726"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679192725"><span class="hs-identifier hs-var">f'</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679192726"><span class="hs-identifier hs-var">t'</span></a><span>
</span><a name="line-105"></a><span>    </span><span class="hs-special">||]</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- | Check if 'Slot' is contained in a 'SlotRange'.</span><span>
</span><a name="line-108"></a><span class="hs-identifier">member</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TExp</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-type">Slot</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ledger.Interval.html#SlotRange"><span class="hs-identifier hs-type">SlotRange</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-109"></a><a name="member"><a href="Ledger.Interval.html#member"><span class="hs-identifier">member</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[||</span><span>
</span><a name="line-110"></a><span>    </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a name="local-6989586621679192727"><a href="#local-6989586621679192727"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-var">Interval</span></a><span> </span><a name="local-6989586621679192728"><a href="#local-6989586621679192728"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679192729"><a href="#local-6989586621679192729"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-111"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679192730"><a href="#local-6989586621679192730"><span class="hs-identifier">lw</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679192728"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a name="local-6989586621679192732"><a href="#local-6989586621679192732"><span class="hs-identifier">f'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679192732"><span class="hs-identifier hs-var">f'</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679192727"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">;</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-112"></a><span>            </span><a name="local-6989586621679192731"><a href="#local-6989586621679192731"><span class="hs-identifier">hg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679192729"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a name="local-6989586621679192733"><a href="#local-6989586621679192733"><span class="hs-identifier">t'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679192733"><span class="hs-identifier hs-var">t'</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679192727"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">;</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-113"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-114"></a><span>            </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679192730"><span class="hs-identifier hs-var">lw</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679192731"><span class="hs-identifier hs-var">hg</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-115"></a><span>    </span><span class="hs-special">||]</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- | Number of 'Slot's covered by the interval. @width (from x) == Nothing@</span><span>
</span><a name="line-118"></a><span class="hs-identifier">width</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TExp</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#SlotRange"><span class="hs-identifier hs-type">SlotRange</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><a name="width"><a href="Ledger.Interval.html#width"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[||</span><span>
</span><a name="line-120"></a><span>    </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-var">Interval</span></a><span> </span><a name="local-6989586621679192734"><a href="#local-6989586621679192734"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679192735"><a href="#local-6989586621679192735"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-121"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679192734"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-122"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-123"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a name="local-6989586621679192736"><a href="#local-6989586621679192736"><span class="hs-identifier">f'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679192735"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-124"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-125"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a name="local-6989586621679192737"><a href="#local-6989586621679192737"><span class="hs-identifier">t'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679192737"><span class="hs-identifier hs-var">t'</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679192736"><span class="hs-identifier hs-var">f'</span></a><span class="hs-special">)</span><span>  </span><span class="hs-special">||]</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-comment">-- | @a `contains` b@ is true if the 'SlotRange' @b@ is entirely contained in </span><span>
</span><a name="line-128"></a><span class="hs-comment">--   @a@. That is, @a `contains` b@ if for every slot @s@, if @member s b@ then</span><span>
</span><a name="line-129"></a><span class="hs-comment">--   @member s a@.</span><span>
</span><a name="line-130"></a><span class="hs-identifier">contains</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TExp</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#SlotRange"><span class="hs-identifier hs-type">SlotRange</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ledger.Interval.html#SlotRange"><span class="hs-identifier hs-type">SlotRange</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-131"></a><a name="contains"><a href="Ledger.Interval.html#contains"><span class="hs-identifier">contains</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[||</span><span>
</span><a name="line-132"></a><span>    </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-var">Interval</span></a><span> </span><a name="local-6989586621679192738"><a href="#local-6989586621679192738"><span class="hs-identifier">af</span></a></a><span> </span><a name="local-6989586621679192739"><a href="#local-6989586621679192739"><span class="hs-identifier">at</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-var">Interval</span></a><span> </span><a name="local-6989586621679192740"><a href="#local-6989586621679192740"><span class="hs-identifier">bf</span></a></a><span> </span><a name="local-6989586621679192741"><a href="#local-6989586621679192741"><span class="hs-identifier">bt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-133"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679192742"><a href="#local-6989586621679192742"><span class="hs-identifier">lw</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679192738"><span class="hs-identifier hs-var">af</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-134"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-135"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a name="local-6989586621679192744"><a href="#local-6989586621679192744"><span class="hs-identifier">af'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679192740"><span class="hs-identifier hs-var">bf</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-136"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-137"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a name="local-6989586621679192745"><a href="#local-6989586621679192745"><span class="hs-identifier">bf'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679192744"><span class="hs-identifier hs-var">af'</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679192745"><span class="hs-identifier hs-var">bf'</span></a><span>
</span><a name="line-138"></a><span>            </span><a name="local-6989586621679192743"><a href="#local-6989586621679192743"><span class="hs-identifier">hg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679192739"><span class="hs-identifier hs-var">at</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-139"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-140"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a name="local-6989586621679192746"><a href="#local-6989586621679192746"><span class="hs-identifier">at'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679192741"><span class="hs-identifier hs-var">bt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-141"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-142"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a name="local-6989586621679192747"><a href="#local-6989586621679192747"><span class="hs-identifier">bt'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679192746"><span class="hs-identifier hs-var">at'</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679192747"><span class="hs-identifier hs-var">bt'</span></a><span>
</span><a name="line-143"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-144"></a><span>            </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679192742"><span class="hs-identifier hs-var">lw</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679192743"><span class="hs-identifier hs-var">hg</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-145"></a><span>    </span><span class="hs-special">||]</span><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span class="hs-comment">-- | Check if a 'Slot' is earlier than the beginning of a 'SlotRange'</span><span>
</span><a name="line-148"></a><span class="hs-identifier">before</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TExp</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-type">Slot</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ledger.Interval.html#SlotRange"><span class="hs-identifier hs-type">SlotRange</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-149"></a><a name="before"><a href="Ledger.Interval.html#before"><span class="hs-identifier">before</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[||</span><span>
</span><a name="line-150"></a><span>    </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a name="local-6989586621679192748"><a href="#local-6989586621679192748"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-var">Interval</span></a><span> </span><a name="local-6989586621679192749"><a href="#local-6989586621679192749"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679192749"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a name="local-6989586621679192750"><a href="#local-6989586621679192750"><span class="hs-identifier">h'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679192750"><span class="hs-identifier hs-var">h'</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679192748"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">;</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-151"></a><span>    </span><span class="hs-special">||]</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">-- | Check if a 'Slot' is later than the end of a 'SlotRange'</span><span>
</span><a name="line-154"></a><span class="hs-identifier">after</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TExp</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-type">Slot</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ledger.Interval.html#SlotRange"><span class="hs-identifier hs-type">SlotRange</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-155"></a><a name="after"><a href="Ledger.Interval.html#after"><span class="hs-identifier">after</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[||</span><span>
</span><a name="line-156"></a><span>    </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a name="local-6989586621679192751"><a href="#local-6989586621679192751"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Interval"><span class="hs-identifier hs-var">Interval</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679192752"><a href="#local-6989586621679192752"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679192752"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Ledger.Interval.html#Slot"><span class="hs-identifier hs-var">Slot</span></a><span> </span><a name="local-6989586621679192753"><a href="#local-6989586621679192753"><span class="hs-identifier">t'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679192751"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679192753"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">;</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-157"></a><span>    </span><span class="hs-special">||]</span><span>
</span><a name="line-158"></a></pre></body></html>